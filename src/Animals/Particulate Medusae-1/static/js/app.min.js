!function(a,b,c){b[a]=b[a]||c(),"undefined"!=typeof module&&module.exports?module.exports=b[a]:"function"==typeof define&&define.amd&&define(function(){return b[a]})}("Promise","undefined"!=typeof global?global:this,function(){"use strict";function a(a,b){m.add(a,b),l||(l=o(m.drain))}function b(a){var b,c=typeof a;return null==a||"object"!=c&&"function"!=c||(b=a.then),"function"==typeof b?b:!1}function c(){for(var a=0;a<this.chain.length;a++)d(this,1===this.state?this.chain[a].success:this.chain[a].failure,this.chain[a]);this.chain.length=0}function d(a,c,d){var e,f;try{c===!1?d.reject(a.msg):(e=c===!0?a.msg:c.call(void 0,a.msg),e===d.promise?d.reject(TypeError("Promise-chain cycle")):(f=b(e))?f.call(e,d.resolve,d.reject):d.resolve(e))}catch(g){d.reject(g)}}function e(d){var g,i=this;if(!i.triggered){i.triggered=!0,i.def&&(i=i.def);try{(g=b(d))?a(function(){var a=new h(i);try{g.call(d,function(){e.apply(a,arguments)},function(){f.apply(a,arguments)})}catch(b){f.call(a,b)}}):(i.msg=d,i.state=1,i.chain.length>0&&a(c,i))}catch(j){f.call(new h(i),j)}}}function f(b){var d=this;d.triggered||(d.triggered=!0,d.def&&(d=d.def),d.msg=b,d.state=2,d.chain.length>0&&a(c,d))}function g(a,b,c,d){for(var e=0;e<b.length;e++)!function(e){a.resolve(b[e]).then(function(a){c(e,a)},d)}(e)}function h(a){this.def=a,this.triggered=!1}function i(a){this.promise=a,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function j(b){if("function"!=typeof b)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var d=new i(this);this.then=function(b,e){var f={success:"function"==typeof b?b:!0,failure:"function"==typeof e?e:!1};return f.promise=new this.constructor(function(a,b){if("function"!=typeof a||"function"!=typeof b)throw TypeError("Not a function");f.resolve=a,f.reject=b}),d.chain.push(f),0!==d.state&&a(c,d),f.promise},this["catch"]=function(a){return this.then(void 0,a)};try{b.call(void 0,function(a){e.call(d,a)},function(a){f.call(d,a)})}catch(g){f.call(d,g)}}var k,l,m,n=Object.prototype.toString,o="undefined"!=typeof setImmediate?function(a){return setImmediate(a)}:setTimeout;try{Object.defineProperty({},"x",{}),k=function(a,b,c,d){return Object.defineProperty(a,b,{value:c,writable:!0,configurable:d!==!1})}}catch(p){k=function(a,b,c){return a[b]=c,a}}m=function(){function a(a,b){this.fn=a,this.self=b,this.next=void 0}var b,c,d;return{add:function(e,f){d=new a(e,f),c?c.next=d:b=d,c=d,d=void 0},drain:function(){var a=b;for(b=c=l=void 0;a;)a.fn.call(a.self),a=a.next}}}();var q=k({},"constructor",j,!1);return j.prototype=q,k(q,"__NPO__",0,!1),k(j,"resolve",function(a){var b=this;return a&&"object"==typeof a&&1===a.__NPO__?a:new b(function(b,c){if("function"!=typeof b||"function"!=typeof c)throw TypeError("Not a function");b(a)})}),k(j,"reject",function(a){return new this(function(b,c){if("function"!=typeof b||"function"!=typeof c)throw TypeError("Not a function");c(a)})}),k(j,"all",function(a){var b=this;return"[object Array]"!=n.call(a)?b.reject(TypeError("Not an array")):0===a.length?b.resolve([]):new b(function(c,d){if("function"!=typeof c||"function"!=typeof d)throw TypeError("Not a function");var e=a.length,f=Array(e),h=0;g(b,a,function(a,b){f[a]=b,++h===e&&c(f)},d)})}),k(j,"race",function(a){var b=this;return"[object Array]"!=n.call(a)?b.reject(TypeError("Not an array")):new b(function(c,d){if("function"!=typeof c||"function"!=typeof d)throw TypeError("Not a function");g(b,a,function(a,b){c(b)},d)})}),j}),function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.Handlebars=b():a.Handlebars=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(){var a=new h.HandlebarsEnvironment;return n.extend(a,h),a.SafeString=j["default"],a.Exception=l["default"],a.Utils=n,a.escapeExpression=n.escapeExpression,a.VM=p,a.template=function(b){return p.template(b,a)},a}var e=c(1)["default"],f=c(2)["default"];b.__esModule=!0;var g=c(3),h=e(g),i=c(17),j=f(i),k=c(5),l=f(k),m=c(4),n=e(m),o=c(18),p=e(o),q=c(19),r=f(q),s=d();s.create=d,r["default"](s),s["default"]=s,b["default"]=s,a.exports=b["default"]},function(a,b){"use strict";b["default"]=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b},b.__esModule=!0},function(a,b){"use strict";b["default"]=function(a){return a&&a.__esModule?a:{"default":a}},b.__esModule=!0},function(a,b,c){"use strict";function d(a,b,c){this.helpers=a||{},this.partials=b||{},this.decorators=c||{},i.registerDefaultHelpers(this),j.registerDefaultDecorators(this)}var e=c(2)["default"];b.__esModule=!0,b.HandlebarsEnvironment=d;var f=c(4),g=c(5),h=e(g),i=c(6),j=c(14),k=c(16),l=e(k),m="4.0.5";b.VERSION=m;var n=7;b.COMPILER_REVISION=n;var o={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};b.REVISION_CHANGES=o;var p="[object Object]";d.prototype={constructor:d,logger:l["default"],log:l["default"].log,registerHelper:function(a,b){if(f.toString.call(a)===p){if(b)throw new h["default"]("Arg not supported with multiple helpers");f.extend(this.helpers,a)}else this.helpers[a]=b},unregisterHelper:function(a){delete this.helpers[a]},registerPartial:function(a,b){if(f.toString.call(a)===p)f.extend(this.partials,a);else{if("undefined"==typeof b)throw new h["default"]('Attempting to register a partial called "'+a+'" as undefined');this.partials[a]=b}},unregisterPartial:function(a){delete this.partials[a]},registerDecorator:function(a,b){if(f.toString.call(a)===p){if(b)throw new h["default"]("Arg not supported with multiple decorators");f.extend(this.decorators,a)}else this.decorators[a]=b},unregisterDecorator:function(a){delete this.decorators[a]}};var q=l["default"].log;b.log=q,b.createFrame=f.createFrame,b.logger=l["default"]},function(a,b){"use strict";function c(a){return k[a]}function d(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function e(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}function f(a){if("string"!=typeof a){if(a&&a.toHTML)return a.toHTML();if(null==a)return"";if(!a)return a+"";a=""+a}return m.test(a)?a.replace(l,c):a}function g(a){return a||0===a?p(a)&&0===a.length?!0:!1:!0}function h(a){var b=d({},a);return b._parent=a,b}function i(a,b){return a.path=b,a}function j(a,b){return(a?a+".":"")+b}b.__esModule=!0,b.extend=d,b.indexOf=e,b.escapeExpression=f,b.isEmpty=g,b.createFrame=h,b.blockParams=i,b.appendContextPath=j;var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},l=/[&<>"'`=]/g,m=/[&<>"'`=]/,n=Object.prototype.toString;b.toString=n;var o=function(a){return"function"==typeof a};o(/x/)&&(b.isFunction=o=function(a){return"function"==typeof a&&"[object Function]"===n.call(a)}),b.isFunction=o;var p=Array.isArray||function(a){return a&&"object"==typeof a?"[object Array]"===n.call(a):!1};b.isArray=p},function(a,b){"use strict";function c(a,b){var e=b&&b.loc,f=void 0,g=void 0;e&&(f=e.start.line,g=e.start.column,a+=" - "+f+":"+g);for(var h=Error.prototype.constructor.call(this,a),i=0;i<d.length;i++)this[d[i]]=h[d[i]];Error.captureStackTrace&&Error.captureStackTrace(this,c),e&&(this.lineNumber=f,this.column=g)}b.__esModule=!0;var d=["description","fileName","lineNumber","message","name","number","stack"];c.prototype=new Error,b["default"]=c,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){g["default"](a),i["default"](a),k["default"](a),m["default"](a),o["default"](a),q["default"](a),s["default"](a)}var e=c(2)["default"];b.__esModule=!0,b.registerDefaultHelpers=d;var f=c(7),g=e(f),h=c(8),i=e(h),j=c(9),k=e(j),l=c(10),m=e(l),n=c(11),o=e(n),p=c(12),q=e(p),r=c(13),s=e(r)},function(a,b,c){"use strict";b.__esModule=!0;var d=c(4);b["default"]=function(a){a.registerHelper("blockHelperMissing",function(b,c){var e=c.inverse,f=c.fn;if(b===!0)return f(this);if(b===!1||null==b)return e(this);if(d.isArray(b))return b.length>0?(c.ids&&(c.ids=[c.name]),a.helpers.each(b,c)):e(this);if(c.data&&c.ids){var g=d.createFrame(c.data);g.contextPath=d.appendContextPath(c.data.contextPath,c.name),c={data:g}}return f(b,c)})},a.exports=b["default"]},function(a,b,c){"use strict";var d=c(2)["default"];b.__esModule=!0;var e=c(4),f=c(5),g=d(f);b["default"]=function(a){a.registerHelper("each",function(a,b){function c(b,c,f){j&&(j.key=b,j.index=c,j.first=0===c,j.last=!!f,k&&(j.contextPath=k+b)),i+=d(a[b],{data:j,blockParams:e.blockParams([a[b],b],[k+b,null])})}if(!b)throw new g["default"]("Must pass iterator to #each");var d=b.fn,f=b.inverse,h=0,i="",j=void 0,k=void 0;if(b.data&&b.ids&&(k=e.appendContextPath(b.data.contextPath,b.ids[0])+"."),e.isFunction(a)&&(a=a.call(this)),b.data&&(j=e.createFrame(b.data)),a&&"object"==typeof a)if(e.isArray(a))for(var l=a.length;l>h;h++)h in a&&c(h,h,h===a.length-1);else{var m=void 0;for(var n in a)a.hasOwnProperty(n)&&(void 0!==m&&c(m,h-1),m=n,h++);void 0!==m&&c(m,h-1,!0)}return 0===h&&(i=f(this)),i})},a.exports=b["default"]},function(a,b,c){"use strict";var d=c(2)["default"];b.__esModule=!0;var e=c(5),f=d(e);b["default"]=function(a){a.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new f["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')})},a.exports=b["default"]},function(a,b,c){"use strict";b.__esModule=!0;var d=c(4);b["default"]=function(a){a.registerHelper("if",function(a,b){return d.isFunction(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||d.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})})},a.exports=b["default"]},function(a,b){"use strict";b.__esModule=!0,b["default"]=function(a){a.registerHelper("log",function(){for(var b=[void 0],c=arguments[arguments.length-1],d=0;d<arguments.length-1;d++)b.push(arguments[d]);var e=1;null!=c.hash.level?e=c.hash.level:c.data&&null!=c.data.level&&(e=c.data.level),b[0]=e,a.log.apply(a,b)})},a.exports=b["default"]},function(a,b){"use strict";b.__esModule=!0,b["default"]=function(a){a.registerHelper("lookup",function(a,b){return a&&a[b]})},a.exports=b["default"]},function(a,b,c){"use strict";b.__esModule=!0;var d=c(4);b["default"]=function(a){a.registerHelper("with",function(a,b){d.isFunction(a)&&(a=a.call(this));var c=b.fn;if(d.isEmpty(a))return b.inverse(this);var e=b.data;return b.data&&b.ids&&(e=d.createFrame(b.data),e.contextPath=d.appendContextPath(b.data.contextPath,b.ids[0])),c(a,{data:e,blockParams:d.blockParams([a],[e&&e.contextPath])})})},a.exports=b["default"]},function(a,b,c){"use strict";function d(a){g["default"](a)}var e=c(2)["default"];b.__esModule=!0,b.registerDefaultDecorators=d;var f=c(15),g=e(f)},function(a,b,c){"use strict";b.__esModule=!0;var d=c(4);b["default"]=function(a){a.registerDecorator("inline",function(a,b,c,e){var f=a;return b.partials||(b.partials={},f=function(e,f){var g=c.partials;c.partials=d.extend({},g,b.partials);var h=a(e,f);return c.partials=g,h}),b.partials[e.args[0]]=e.fn,f})},a.exports=b["default"]},function(a,b,c){"use strict";b.__esModule=!0;var d=c(4),e={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(a){if("string"==typeof a){var b=d.indexOf(e.methodMap,a.toLowerCase());a=b>=0?b:parseInt(a,10)}return a},log:function(a){if(a=e.lookupLevel(a),"undefined"!=typeof console&&e.lookupLevel(e.level)<=a){var b=e.methodMap[a];console[b]||(b="log");for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;c>f;f++)d[f-1]=arguments[f];console[b].apply(console,d)}}};b["default"]=e,a.exports=b["default"]},function(a,b){"use strict";function c(a){this.string=a}b.__esModule=!0,c.prototype.toString=c.prototype.toHTML=function(){return""+this.string},b["default"]=c,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){var b=a&&a[0]||1,c=r.COMPILER_REVISION;if(b!==c){if(c>b){var d=r.REVISION_CHANGES[c],e=r.REVISION_CHANGES[b];throw new q["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new q["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){function c(c,d,e){e.hash&&(d=o.extend({},d,e.hash),e.ids&&(e.ids[0]=!0)),c=b.VM.resolvePartial.call(this,c,d,e);var f=b.VM.invokePartial.call(this,c,d,e);if(null==f&&b.compile&&(e.partials[e.name]=b.compile(c,a.compilerOptions,b),f=e.partials[e.name](d,e)),null!=f){if(e.indent){for(var g=f.split("\n"),h=0,i=g.length;i>h&&(g[h]||h+1!==i);h++)g[h]=e.indent+g[h];f=g.join("\n")}return f}throw new q["default"]("The partial "+e.name+" could not be compiled when running in runtime-only mode")}function d(b){function c(b){return""+a.main(e,b,e.helpers,e.partials,g,i,h)}var f=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],g=f.data;d._setup(f),!f.partial&&a.useData&&(g=j(b,g));var h=void 0,i=a.useBlockParams?[]:void 0;return a.useDepths&&(h=f.depths?b!==f.depths[0]?[b].concat(f.depths):f.depths:[b]),(c=k(a.main,c,e,f.depths||[],g,i))(b,f)}if(!b)throw new q["default"]("No environment passed to template");if(!a||!a.main)throw new q["default"]("Unknown template object: "+typeof a);a.main.decorator=a.main_d,b.VM.checkRevision(a.compiler);var e={strict:function(a,b){if(!(b in a))throw new q["default"]('"'+b+'" not defined in '+a);return a[b]},lookup:function(a,b){for(var c=a.length,d=0;c>d;d++)if(a[d]&&null!=a[d][b])return a[d][b]},lambda:function(a,b){return"function"==typeof a?a.call(b):a},escapeExpression:o.escapeExpression,invokePartial:c,fn:function(b){var c=a[b];return c.decorator=a[b+"_d"],c},programs:[],program:function(a,b,c,d,e){var g=this.programs[a],h=this.fn(a);return b||e||d||c?g=f(this,a,h,b,c,d,e):g||(g=this.programs[a]=f(this,a,h)),g},data:function(a,b){for(;a&&b--;)a=a._parent;return a},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c=o.extend({},b,a)),c},noop:b.VM.noop,compilerInfo:a.compiler};return d.isTop=!0,d._setup=function(c){c.partial?(e.helpers=c.helpers,e.partials=c.partials,e.decorators=c.decorators):(e.helpers=e.merge(c.helpers,b.helpers),a.usePartial&&(e.partials=e.merge(c.partials,b.partials)),(a.usePartial||a.useDecorators)&&(e.decorators=e.merge(c.decorators,b.decorators)))},d._child=function(b,c,d,g){if(a.useBlockParams&&!d)throw new q["default"]("must pass block params");if(a.useDepths&&!g)throw new q["default"]("must pass parent depths");return f(e,b,a[b],c,0,d,g)},d}function f(a,b,c,d,e,f,g){function h(b){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],h=g;return g&&b!==g[0]&&(h=[b].concat(g)),c(a,b,a.helpers,a.partials,e.data||d,f&&[e.blockParams].concat(f),h)}return h=k(c,h,a,g,d,f),h.program=b,h.depth=g?g.length:0,h.blockParams=e||0,h}function g(a,b,c){return a?a.call||c.name||(c.name=a,a=c.partials[a]):a="@partial-block"===c.name?c.data["partial-block"]:c.partials[c.name],a}function h(a,b,c){c.partial=!0,c.ids&&(c.data.contextPath=c.ids[0]||c.data.contextPath);var d=void 0;if(c.fn&&c.fn!==i&&(c.data=r.createFrame(c.data),d=c.data["partial-block"]=c.fn,d.partials&&(c.partials=o.extend({},c.partials,d.partials))),void 0===a&&d&&(a=d),void 0===a)throw new q["default"]("The partial "+c.name+" could not be found");return a instanceof Function?a(b,c):void 0}function i(){return""}function j(a,b){return b&&"root"in b||(b=b?r.createFrame(b):{},b.root=a),b}function k(a,b,c,d,e,f){if(a.decorator){var g={};b=a.decorator(b,g,c,d&&d[0],e,f,d),o.extend(b,g)}return b}var l=c(1)["default"],m=c(2)["default"];b.__esModule=!0,b.checkRevision=d,b.template=e,b.wrapProgram=f,b.resolvePartial=g,b.invokePartial=h,b.noop=i;var n=c(4),o=l(n),p=c(5),q=m(p),r=c(3)},function(a,b){(function(c){"use strict";b.__esModule=!0,b["default"]=function(a){var b="undefined"!=typeof c?c:window,d=b.Handlebars;a.noConflict=function(){return b.Handlebars===a&&(b.Handlebars=d),a}},a.exports=b["default"]}).call(b,function(){return this}())}])}),function(a,b){"function"==typeof define&&define.amd?define("particulate",[],function(){return a.Particulate=b()}):"object"==typeof exports?module.exports=b():a.Particulate=b()}(this,function(){"use strict";function a(a,b){b=b||{},this.vector=new Float32Array(3),b.type&&(this.type=b.type),null!=a&&this.set(a)}function b(a){n.Force.call(this,a)}function c(a,b){b=b||{},n.Force.apply(this,arguments),this.intensity=b.intensity||.05,this.setRadius(b.radius||0)}function d(a,b,c){c=c||0,this.indices=new Uint16Array(a+c),this._count=a/b,this._itemSize=b,this._offset=c}function e(a,b,c,d){var e=b.length||arguments.length-1,f=a.length?a[0]:a,g=a.length?a[1]:a;n.Constraint.call(this,e,3),this.setAngle(f,g),this.setIndices(b,c,d)}function f(a,b,c){var d=c.length||1;n.Constraint.call(this,d,1,2),this.setAxis(a,b),this.setIndices(c)}function g(a,b,c){this.distance=c||0,this.friction=.05,this.bufferVec3=n.Vec3.create(2),this.setOrigin(a),this.setNormal(b)}function h(a,b){this.friction=.05,this.bufferVec3=n.Vec3.create(2),this.setBounds(a,b)}function i(a,b,c){var d=b.length||arguments.length-1,e=a.length?a[0]:a,f=a.length?a[1]:a;n.Constraint.call(this,d,2),this.setDistance(e,f),this.setIndices(b,c)}function j(a,b,c,d){var e=d.length||1;n.Constraint.call(this,e,1,3),this.bufferVec3=n.Vec3.create(1),this.setPlane(a,b,c),this.setIndices(d)}function k(a,b){var c=b.length||1;n.Constraint.call(this,c,1),this.bufferVec3=n.Vec3.create(1),this.setPosition(a),this.setIndices(b)}function l(a,b){var c="number"==typeof a,d=c?3*a:a.length,e=d/3,f=c?d:a;this.positions=new Float32Array(f),this.positionsPrev=new Float32Array(f),this.accumulatedForces=new Float32Array(d),this.weights=new Float32Array(e),this.setWeights(1),this._iterations=b||1,this._count=e,this._globalConstraints=[],this._localConstraints=[],this._pinConstraints=[],this._forces=[]}function m(a,b,c,d,e,f){var g=b[a];b[a]+=g-c[a]+d[a]*e*f,c[a]=g}var n;n={VERSION:"0.3.2"};var o=n.Collection={};o.removeAll=function(a,b){var c=a.indexOf(b);if(!(0>c))for(var d=a.length-1;d>=c;d--)a[d]===b&&a.splice(d,1)},n.ctor=function(a){return function(){var b=Object.create(a.prototype);return a.apply(b,arguments),b}},n.Math={},n.Math.clamp=function(a,b,c){return Math.min(Math.max(c,a),b)};var p=n.Vec3={};p.create=function(a){a=a||1;var b="number"==typeof a;return new Float32Array(b?3*a:a)},p.set=function(a,b,c,d,e){var f=3*b,g=f+1,h=f+2;null==d&&(e=c[2],d=c[1],c=c[0]),a[f]=c,a[g]=d,a[h]=e},p.copy=function(a,b,c){var d=3*b,e=d+1,f=d+2;return c[0]=a[d],c[1]=a[e],c[2]=a[f],c},p.lengthSq=function(a,b){var c=3*b,d=c+1,e=c+2,f=a[c],g=a[d],h=a[e];return f*f+g*g+h*h},p.length=function(a,b){var c=3*b,d=c+1,e=c+2,f=a[c],g=a[d],h=a[e];return Math.sqrt(f*f+g*g+h*h)},p.distanceSq=function(a,b,c){var d=3*b,e=d+1,f=d+2,g=3*c,h=g+1,i=g+2,j=a[d]-a[g],k=a[e]-a[h],l=a[f]-a[i];return j*j+k*k+l*l},p.distance=function(a,b,c){var d=3*b,e=d+1,f=d+2,g=3*c,h=g+1,i=g+2,j=a[d]-a[g],k=a[e]-a[h],l=a[f]-a[i];return Math.sqrt(j*j+k*k+l*l)},p.normalize=function(a,b){var c=3*b,d=c+1,e=c+2,f=a[c],g=a[d],h=a[e],i=1/Math.sqrt(f*f+g*g+h*h);a[c]*=i,a[d]*=i,a[e]*=i},p.angle=function(a,b,c,d){var e=3*b,f=e+1,g=e+2,h=3*c,i=h+1,j=h+2,k=3*d,l=k+1,m=k+2,n=1/p.distance(a,c,b),o=1/p.distance(a,c,d),q=(a[e]-a[h])*n,r=(a[f]-a[i])*n,s=(a[g]-a[j])*n,t=(a[k]-a[h])*o,u=(a[l]-a[i])*o,v=(a[m]-a[j])*o,w=q*t+r*u+s*v;return Math.acos(w)},n.Force=a,a.create=n.ctor(a),a.ATTRACTOR=0,a.REPULSOR=1,a.ATTRACTOR_REPULSOR=2,a.prototype.type=a.ATTRACTOR,a.prototype.set=function(a,b,c){n.Vec3.set(this.vector,0,a,b,c)},a.prototype.applyForce=function(a,b,c,d){},n.DirectionalForce=b,b.create=n.ctor(b),b.prototype=Object.create(n.Force.prototype),b.prototype.constructor=b,b.prototype.applyForce=function(a,b,c,d){var e=this.vector;b[a]+=e[0],b[a+1]+=e[1],b[a+2]+=e[2]},n.PointForce=c;var q=n.Force.ATTRACTOR,r=n.Force.REPULSOR,s=n.Force.ATTRACTOR_REPULSOR;return c.create=n.ctor(c),c.prototype=Object.create(n.Force.prototype),c.prototype.constructor=c,c.prototype.setRadius=function(a){this._radius2=a*a},c.prototype._radius2=null,c.prototype.applyForce=function(a,b,c,d){var e,f,g=this.vector,h=a+1,i=a+2,j=c[a]-g[0],k=c[h]-g[1],l=c[i]-g[2],m=j*j+k*k+l*l,n=m-this._radius2;switch(this.type){case q:e=m>0&&n>0;break;case r:e=m>0&&0>n;break;case s:e=j||k||l}e&&(f=n/m*this.intensity,b[a]-=j*f,b[h]-=k*f,b[i]-=l*f)},n.Constraint=d,d.create=n.ctor(d),d.prototype.setIndices=function(a){for(var b=this._offset,c=a.length?a:arguments,d=this.indices,e=0;e<c.length;e++)d[e+b]=c[e]},d.prototype.applyConstraint=function(a,b,c){},n.AngleConstraint=e,e.create=n.ctor(e),e.prototype=Object.create(n.Constraint.prototype),e.prototype.constructor=e,e.prototype.setAngle=function(a,b){b=null!=b?b:a,this.setMin(a),this.setMax(b)},e.prototype.setMin=function(a){this._min=this.clampAngle(a)},e.prototype._min=null,e.prototype.setMax=function(a){this._max=this.clampAngle(a)},e.prototype._max=null,e.prototype.clampAngle=function(a){var b=1e-7;return n.Math.clamp(b,Math.PI-b,a)},e.ANGLE_OBTUSE=.75*Math.PI,e.prototype.applyConstraint=function(a,b,c){var d=this.indices,f=d[a],g=d[a+1],h=d[a+2],i=3*f,j=i+1,k=i+2,l=3*g,m=l+1,n=l+2,o=3*h,p=o+1,q=o+2,r=b[l]-b[i],s=b[m]-b[j],t=b[n]-b[k],u=b[o]-b[l],v=b[p]-b[m],w=b[q]-b[n],x=b[o]-b[i],y=b[p]-b[j],z=b[q]-b[k];if(!(x||y||z))return b[i]+=.1,b[m]+=.1,void(b[o]-=.1);var A=r*r+s*s+t*t,B=u*u+v*v+w*w,C=x*x+y*y+z*z,D=Math.sqrt(A),E=Math.sqrt(B),F=Math.sqrt(C),G=1/D,H=1/E,I=this._min,J=this._max,K=Math.acos(-r*G*u*H+-s*G*v*H+-t*G*w*H);if(!(K>I&&J>K)){var L=I>K?I:J,M=A+B-2*D*E*Math.cos(L),N=Math.sqrt(M),O=(F-N)/F*.5;if(b[i]+=x*O,b[j]+=y*O,b[k]+=z*O,b[o]-=x*O,b[p]-=y*O,b[q]-=z*O,!(L<e.ANGLE_OBTUSE)){var P=Math.acos((A+M-B)/(2*D*N)),Q=1/F,R=x*Q,S=y*Q,T=z*Q,U=R*r+S*s+T*t,V=R*U,W=S*U,X=T*U,Y=V-r,Z=W-s,$=X-t;if(!(Y||Z||$))return void(L<Math.PI&&(b[l]+=.1,b[m]+=.1,b[n]+=.1));var _=V*V+W*W+X*X,aa=Y*Y+Z*Z+$*$,ba=Math.sqrt(_),ca=Math.sqrt(aa),da=ba*Math.tan(P),ea=(ca-da)/ca;b[l]+=Y*ea,b[m]+=Z*ea,b[n]+=$*ea}}},n.AxisConstraint=f,f.create=n.ctor(f),f.prototype=Object.create(n.Constraint.prototype),f.prototype.constructor=f,f.prototype.setAxis=function(a,b){var c=this.indices;c[0]=a,c[1]=b},f.prototype.applyConstraint=function(a,b,c){var d=this.indices,e=d[0],f=d[a+2],g=d[1],h=3*e,i=h+1,j=h+2,k=3*f,l=k+1,m=k+2,n=3*g,o=n+1,p=n+2,q=b[k]-b[h],r=b[l]-b[i],s=b[m]-b[j],t=b[n]-b[h],u=b[o]-b[i],v=b[p]-b[j],w=t*t+u*u+v*v,x=Math.sqrt(w),y=1/x,z=t*y,A=u*y,B=v*y,C=z*q+A*r+B*s,D=z*C,E=A*C,F=B*C;b[k]=b[h]+D,b[l]=b[i]+E,b[m]=b[j]+F},n.BoundingPlaneConstraint=g,g.create=n.ctor(g),g.prototype=Object.create(n.Constraint.prototype),g.prototype.constructor=g,g.prototype._isGlobal=!0,g.prototype.setOrigin=function(a,b,c){n.Vec3.set(this.bufferVec3,0,a,b,c)},g.prototype.setNormal=function(a,b,c){n.Vec3.set(this.bufferVec3,1,a,b,c),n.Vec3.normalize(this.bufferVec3,1)},g.prototype.applyConstraint=function(a,b,c){var d=this.friction,e=this.bufferVec3,f=a,g=f+1,h=f+2,i=b[f]-e[0],j=b[g]-e[1],k=b[h]-e[2],l=e[3],m=e[4],n=e[5],o=i*l+j*m+k*n;o>this.distance||(b[f]-=l*o,b[g]-=m*o,b[h]-=n*o,c[f]-=(c[f]-b[f])*d,c[g]-=(c[g]-b[g])*d,c[h]-=(c[h]-b[h])*d)},n.BoxConstraint=h,h.create=n.ctor(h),h.prototype=Object.create(n.Constraint.prototype),h.prototype.constructor=h,h.prototype._isGlobal=!0,h.prototype.setBounds=function(a,b){this.setMin(a),this.setMax(b)},h.prototype.setMin=function(a,b,c){n.Vec3.set(this.bufferVec3,0,a,b,c)},h.prototype.setMax=function(a,b,c){n.Vec3.set(this.bufferVec3,1,a,b,c)},h.prototype.applyConstraint=function(a,b,c){var d=this.friction,e=this.bufferVec3,f=a,g=f+1,h=f+2,i=n.Math.clamp(e[0],e[3],b[f]),j=n.Math.clamp(e[1],e[4],b[g]),k=n.Math.clamp(e[2],e[5],b[h]),l=b[f]-i,m=b[g]-j,o=b[h]-k;b[f]=i,b[g]=j,b[h]=k,(l||m||o)&&(c[f]-=(c[f]-i)*d,c[g]-=(c[g]-j)*d,c[h]-=(c[h]-k)*d)},n.DistanceConstraint=i,i.create=n.ctor(i),i.prototype=Object.create(n.Constraint.prototype),i.prototype.constructor=i,i.prototype.setDistance=function(a,b){this.setMin(a),this.setMax(null!=b?b:a)},i.prototype.setMin=function(a){this._min2=a*a},i.prototype._min2=null,i.prototype.setMax=function(a){this._max2=a*a},i.prototype._max2=null,i.prototype.applyConstraint=function(a,b,c){var d=this.indices,e=d[a],f=d[a+1],g=3*e,h=g+1,i=g+2,j=3*f,k=j+1,l=j+2,m=b[j]-b[g],n=b[k]-b[h],o=b[l]-b[i];m||n||o||(m=n=o=.1);var p=m*m+n*n+o*o,q=this._min2,r=this._max2;if(!(r>p&&p>q)){var s=q>p?q:r,t=s/(p+s),u=t-.5,v=t-.5;b[g]-=m*u,b[h]-=n*u,b[i]-=o*u,b[j]+=m*v,b[k]+=n*v,b[l]+=o*v}},n.PlaneConstraint=j,j.create=n.ctor(j),j.prototype=Object.create(n.Constraint.prototype),j.prototype.constructor=j,j.prototype.setPlane=function(a,b,c){var d=this.indices;d[0]=a,d[1]=b,d[2]=c},j.prototype._calculateNormal=function(a,b){var c=this.bufferVec3,d=this.indices,e=d[0],f=d[1],g=d[2],h=3*e,i=h+1,j=h+2,k=3*f,l=k+1,m=k+2,n=3*g,o=n+1,p=n+2,q=b[h]-b[k],r=b[i]-b[l],s=b[j]-b[m],t=b[n]-b[k],u=b[o]-b[l],v=b[p]-b[m],w=r*v-s*u,x=s*t-q*v,y=q*u-r*t,z=w*w+x*x+y*y;if(!z)return b[h]+=.1,b[l]+=.1,b[n]-=.1,void(this._hasNormal=!1);var A=1/Math.sqrt(z);c[0]=w*A,c[1]=x*A,c[2]=y*A,this._hasNormal=!0},j.prototype._hasNormal=!1,j.prototype.applyConstraint=function(a,b,c){var d=this.bufferVec3,e=this.indices,f=e[1],g=e[a+3],h=3*f,i=h+1,j=h+2,k=3*g,l=k+1,m=k+2;if(0===a&&this._calculateNormal(a,b),this._hasNormal){var n=d[0],o=d[1],p=d[2],q=b[k]-b[h],r=b[l]-b[i],s=b[m]-b[j],t=q*n+r*o+s*p;b[k]-=n*t,b[l]-=o*t,b[m]-=p*t}},n.PointConstraint=k,k.create=n.ctor(k),k.prototype=Object.create(n.Constraint.prototype),k.prototype.constructor=k,k.prototype.setPosition=function(a,b,c){n.Vec3.set(this.bufferVec3,0,a,b,c)},k.prototype.applyConstraint=function(a,b,c){var d=this.bufferVec3,e=this.indices[a],f=3*e,g=f+1,h=f+2;b[f]=c[f]=d[0],b[g]=c[g]=d[1],b[h]=c[h]=d[2]},n.ParticleSystem=l,l.create=n.ctor(l),l.prototype.constructor=l,l.prototype.setPosition=function(a,b,c,d){n.Vec3.set(this.positions,a,b,c,d),n.Vec3.set(this.positionsPrev,a,b,c,d)},l.prototype.getPosition=function(a,b){return n.Vec3.copy(this.positions,a,b)},l.prototype.getDistance=function(a,b){return n.Vec3.distance(this.positions,a,b)},l.prototype.getAngle=function(a,b,c){return n.Vec3.angle(this.positions,a,b,c)},l.prototype.setWeight=function(a,b){this.weights[a]=b},l.prototype.setWeights=function(a){for(var b=this.weights,c=0,d=b.length;d>c;c++)b[c]=a},l.prototype.each=function(a,b){b=b||this;for(var c=0,d=this._count;d>c;c++)a.call(b,c,this)},l.prototype.perturb=function(a){for(var b,c=this.positions,d=this.positionsPrev,e=0,f=c.length;f>e;e++)b=Math.random()*a,c[e]+=b,d[e]+=b},l.prototype.integrate=function(a){for(var b,c,d=a*a,e=this.positions,f=this.positionsPrev,g=this.accumulatedForces,h=this.weights,i=0,j=this._count;j>i;i++)c=h[i],b=3*i,m(b,e,f,g,c,d),m(b+1,e,f,g,c,d),m(b+2,e,f,g,c,d)},l.prototype._getConstraintBuffer=function(a){return a._isGlobal?this._globalConstraints:this._localConstraints},l.prototype.addConstraint=function(a){this._getConstraintBuffer(a).push(a)},l.prototype.removeConstraint=function(a){n.Collection.removeAll(this._getConstraintBuffer(a),a)},l.prototype.addPinConstraint=function(a){this._pinConstraints.push(a)},l.prototype.removePinConstraint=function(a){n.Collection.removeAll(this._pinConstraints,a)},l.prototype.satisfyConstraints=function(){for(var a=this._iterations,b=this._globalConstraints,c=this._localConstraints,d=this._pinConstraints,e=this._count,f=3,g=0;a>g;g++)this.satisfyConstraintGroup(b,e,f),this.satisfyConstraintGroup(c),d.length&&this.satisfyConstraintGroup(d)},l.prototype.satisfyConstraintGroup=function(a,b,c){for(var d,e=this.positions,f=this.positionsPrev,g=!b,h=0,i=a.length;i>h;h++){d=a[h],g&&(b=d._count,c=d._itemSize);for(var j=0;b>j;j++)d.applyConstraint(j*c,e,f)}},l.prototype.addForce=function(a){this._forces.push(a)},l.prototype.removeForce=function(a){n.Collection.removeAll(this._forces,a)},l.prototype.accumulateForces=function(a){for(var b,c=this._forces,d=this.accumulatedForces,e=this.positions,f=this.positionsPrev,g=0,h=this._count;h>g;g++){b=3*g,d[b]=d[b+1]=d[b+2]=0;for(var i=0,j=c.length;j>i;i++)c[i].applyForce(b,d,e,f)}},l.prototype.tick=function(a){this.accumulateForces(a),this.integrate(a),this.satisfyConstraints()},n}),function(a){function b(a,b,c){this.x=a,this.y=b,this.z=c}function c(a){return a*a*a*(a*(6*a-15)+10)}function d(a,b,c){return(1-c)*a+c*b}var e=a.noise={};b.prototype.dot2=function(a,b){return this.x*a+this.y*b},b.prototype.dot3=function(a,b,c){return this.x*a+this.y*b+this.z*c};var f=[new b(1,1,0),new b(-1,1,0),new b(1,-1,0),new b(-1,-1,0),new b(1,0,1),new b(-1,0,1),new b(1,0,-1),new b(-1,0,-1),new b(0,1,1),new b(0,-1,1),new b(0,1,-1),new b(0,-1,-1)],g=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],h=new Array(512),i=new Array(512);e.seed=function(a){a>0&&1>a&&(a*=65536),a=Math.floor(a),256>a&&(a|=a<<8);for(var b=0;256>b;b++){var c;c=1&b?g[b]^255&a:g[b]^a>>8&255,h[b]=h[b+256]=c,i[b]=i[b+256]=f[c%12]}},e.seed(0);var j=.5*(Math.sqrt(3)-1),k=(3-Math.sqrt(3))/6,l=1/3,m=1/6;e.simplex2=function(a,b){var c,d,e,f,g,l=(a+b)*j,m=Math.floor(a+l),n=Math.floor(b+l),o=(m+n)*k,p=a-m+o,q=b-n+o;p>q?(f=1,g=0):(f=0,g=1);var r=p-f+k,s=q-g+k,t=p-1+2*k,u=q-1+2*k;m&=255,n&=255;var v=i[m+h[n]],w=i[m+f+h[n+g]],x=i[m+1+h[n+1]],y=.5-p*p-q*q;0>y?c=0:(y*=y,c=y*y*v.dot2(p,q));var z=.5-r*r-s*s;0>z?d=0:(z*=z,d=z*z*w.dot2(r,s));var A=.5-t*t-u*u;return 0>A?e=0:(A*=A,e=A*A*x.dot2(t,u)),70*(c+d+e)},e.simplex3=function(a,b,c){var d,e,f,g,j,k,n,o,p,q,r=(a+b+c)*l,s=Math.floor(a+r),t=Math.floor(b+r),u=Math.floor(c+r),v=(s+t+u)*m,w=a-s+v,x=b-t+v,y=c-u+v;w>=x?x>=y?(j=1,k=0,n=0,o=1,p=1,q=0):w>=y?(j=1,k=0,n=0,o=1,p=0,q=1):(j=0,k=0,n=1,o=1,p=0,q=1):y>x?(j=0,k=0,n=1,o=0,p=1,q=1):y>w?(j=0,k=1,n=0,o=0,p=1,q=1):(j=0,k=1,n=0,o=1,p=1,q=0);var z=w-j+m,A=x-k+m,B=y-n+m,C=w-o+2*m,D=x-p+2*m,E=y-q+2*m,F=w-1+3*m,G=x-1+3*m,H=y-1+3*m;s&=255,t&=255,u&=255;var I=i[s+h[t+h[u]]],J=i[s+j+h[t+k+h[u+n]]],K=i[s+o+h[t+p+h[u+q]]],L=i[s+1+h[t+1+h[u+1]]],M=.6-w*w-x*x-y*y;0>M?d=0:(M*=M,d=M*M*I.dot3(w,x,y));var N=.6-z*z-A*A-B*B;0>N?e=0:(N*=N,e=N*N*J.dot3(z,A,B));var O=.6-C*C-D*D-E*E;0>O?f=0:(O*=O,f=O*O*K.dot3(C,D,E));var P=.6-F*F-G*G-H*H;return 0>P?g=0:(P*=P,g=P*P*L.dot3(F,G,H)),32*(d+e+f+g)},e.perlin2=function(a,b){var e=Math.floor(a),f=Math.floor(b);a-=e,b-=f,e=255&e,f=255&f;var g=i[e+h[f]].dot2(a,b),j=i[e+h[f+1]].dot2(a,b-1),k=i[e+1+h[f]].dot2(a-1,b),l=i[e+1+h[f+1]].dot2(a-1,b-1),m=c(a);return d(d(g,k,m),d(j,l,m),c(b))},e.perlin3=function(a,b,e){var f=Math.floor(a),g=Math.floor(b),j=Math.floor(e);a-=f,b-=g,e-=j,f=255&f,g=255&g,j=255&j;var k=i[f+h[g+h[j]]].dot3(a,b,e),l=i[f+h[g+h[j+1]]].dot3(a,b,e-1),m=i[f+h[g+1+h[j]]].dot3(a,b-1,e),n=i[f+h[g+1+h[j+1]]].dot3(a,b-1,e-1),o=i[f+1+h[g+h[j]]].dot3(a-1,b,e),p=i[f+1+h[g+h[j+1]]].dot3(a-1,b,e-1),q=i[f+1+h[g+1+h[j]]].dot3(a-1,b-1,e),r=i[f+1+h[g+1+h[j+1]]].dot3(a-1,b-1,e-1),s=c(a),t=c(b),u=c(e);
return d(d(d(k,o,s),d(l,p,s),u),d(d(m,q,s),d(n,r,s),u),t)}}(this),THREE.TrackballControls=function(a,b){function c(a){l.enabled!==!1&&(window.removeEventListener("keydown",c),p=o,o===m.NONE&&(a.keyCode!==l.keys[m.ROTATE]||l.noRotate?a.keyCode!==l.keys[m.ZOOM]||l.noZoom?a.keyCode!==l.keys[m.PAN]||l.noPan||(o=m.PAN):o=m.ZOOM:o=m.ROTATE))}function d(a){l.enabled!==!1&&(o=p,window.addEventListener("keydown",c,!1))}function e(a){l.enabled!==!1&&(o===m.NONE&&(o=a.button),o!==m.ROTATE||l.noRotate?o!==m.ZOOM||l.noZoom?o!==m.PAN||l.noPan||(l.getMouseOnScreen(a.pageX,a.pageY,x),y.copy(x)):(l.getMouseOnScreen(a.pageX,a.pageY,t),u.copy(t)):(l.getMouseProjectionOnBall(a.pageX,a.pageY,r),s.copy(r)),document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",g,!1),l.dispatchEvent(A))}function f(a){l.enabled!==!1&&(a.preventDefault(),a.stopPropagation(),o!==m.ROTATE||l.noRotate?o!==m.ZOOM||l.noZoom?o!==m.PAN||l.noPan||l.getMouseOnScreen(a.pageX,a.pageY,y):l.getMouseOnScreen(a.pageX,a.pageY,u):l.getMouseProjectionOnBall(a.pageX,a.pageY,s))}function g(a){l.enabled!==!1&&(a.preventDefault(),a.stopPropagation(),o=m.NONE,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),l.dispatchEvent(B))}function h(a){if(l.enabled!==!1){a.preventDefault(),a.stopPropagation();var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail/3),t.y+=.01*b,l.dispatchEvent(A),l.dispatchEvent(B)}}function i(a){if(l.enabled!==!1){switch(a.touches.length){case 1:o=m.TOUCH_ROTATE,s.copy(l.getMouseProjectionOnBall(a.touches[0].pageX,a.touches[0].pageY,r));break;case 2:o=m.TOUCH_ZOOM;var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;w=v=Math.sqrt(b*b+c*c);break;case 3:o=m.TOUCH_PAN,y.copy(l.getMouseOnScreen(a.touches[0].pageX,a.touches[0].pageY,x));break;default:o=m.NONE}l.dispatchEvent(A)}}function j(a){if(l.enabled!==!1)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:l.getMouseProjectionOnBall(a.touches[0].pageX,a.touches[0].pageY,s);break;case 2:var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;w=Math.sqrt(b*b+c*c);break;case 3:l.getMouseOnScreen(a.touches[0].pageX,a.touches[0].pageY,y);break;default:o=m.NONE}}function k(a){if(l.enabled!==!1){switch(a.touches.length){case 1:r.copy(l.getMouseProjectionOnBall(a.touches[0].pageX,a.touches[0].pageY,s));break;case 2:v=w=0;break;case 3:x.copy(l.getMouseOnScreen(a.touches[0].pageX,a.touches[0].pageY,y))}o=m.NONE,l.dispatchEvent(B)}}var l=this,m={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5};this.object=a,this.domElement=void 0!==b?b:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var n=new THREE.Vector3,o=m.NONE,p=m.NONE,q=new THREE.Vector3,r=new THREE.Vector3,s=new THREE.Vector3,t=new THREE.Vector2,u=new THREE.Vector2,v=0,w=0,x=new THREE.Vector2,y=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var z={type:"change"},A={type:"start"},B={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{this.screen=this.domElement.getBoundingClientRect();var a=this.domElement.ownerDocument.documentElement;this.screen.left+=window.pageXOffset-a.clientLeft,this.screen.top+=window.pageYOffset-a.clientTop}},this.handleEvent=function(a){"function"==typeof this[a.type]&&this[a.type](a)},this.getMouseOnScreen=function(a,b,c){return c.set((a-l.screen.left)/l.screen.width,(b-l.screen.top)/l.screen.height)},this.getMouseProjectionOnBall=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){b.set((c-.5*l.screen.width-l.screen.left)/(.5*l.screen.width),(.5*l.screen.height+l.screen.top-d)/(.5*l.screen.height),0);var f=b.length();return l.noRoll?f<Math.SQRT1_2?b.z=Math.sqrt(1-f*f):b.z=.5/f:f>1?b.normalize():b.z=Math.sqrt(1-f*f),q.copy(l.object.position).sub(l.target),e.copy(l.object.up).setLength(b.y),e.add(a.copy(l.object.up).cross(q).setLength(b.x)),e.add(q.setLength(b.z)),e}}(),this.rotateCamera=function(){var a=new THREE.Vector3,b=new THREE.Quaternion;return function(){var c=Math.acos(r.dot(s)/r.length()/s.length());c&&(a.crossVectors(r,s).normalize(),c*=l.rotateSpeed,b.setFromAxisAngle(a,-c),q.applyQuaternion(b),l.object.up.applyQuaternion(b),s.applyQuaternion(b),l.staticMoving?r.copy(s):(b.setFromAxisAngle(a,c*(l.dynamicDampingFactor-1)),r.applyQuaternion(b)))}}(),this.zoomCamera=function(){if(o===m.TOUCH_ZOOM){var a=v/w;v=w,q.multiplyScalar(a)}else{var a=1+(u.y-t.y)*l.zoomSpeed;1!==a&&a>0&&(q.multiplyScalar(a),l.staticMoving?t.copy(u):t.y+=(u.y-t.y)*this.dynamicDampingFactor)}},this.panCamera=function(){var a=new THREE.Vector2,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.copy(y).sub(x),a.lengthSq()&&(a.multiplyScalar(q.length()*l.panSpeed),c.copy(q).cross(l.object.up).setLength(a.x),c.add(b.copy(l.object.up).setLength(a.y)),l.object.position.add(c),l.target.add(c),l.staticMoving?x.copy(y):x.add(a.subVectors(y,x).multiplyScalar(l.dynamicDampingFactor)))}}(),this.checkDistances=function(){l.noZoom&&l.noPan||(q.lengthSq()>l.maxDistance*l.maxDistance&&l.object.position.addVectors(l.target,q.setLength(l.maxDistance)),q.lengthSq()<l.minDistance*l.minDistance&&l.object.position.addVectors(l.target,q.setLength(l.minDistance)))},this.update=function(){q.subVectors(l.object.position,l.target),l.noRotate||l.rotateCamera(),l.noZoom||l.zoomCamera(),l.noPan||l.panCamera(),l.object.position.addVectors(l.target,q),l.checkDistances(),l.object.lookAt(l.target),n.distanceToSquared(l.object.position)>0&&(l.dispatchEvent(z),n.copy(l.object.position))},this.reset=function(){o=m.NONE,p=m.NONE,l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.up.copy(l.up0),q.subVectors(l.object.position,l.target),l.object.lookAt(l.target),l.dispatchEvent(z),n.copy(l.object.position)},this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousedown",e,!1),this.domElement.addEventListener("mousewheel",h,!1),this.domElement.addEventListener("DOMMouseScroll",h,!1),this.domElement.addEventListener("touchstart",i,!1),this.domElement.addEventListener("touchend",k,!1),this.domElement.addEventListener("touchmove",j,!1),window.addEventListener("keydown",c,!1),window.addEventListener("keyup",d,!1),this.handleResize()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.PlaneBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};for(var e=a/2,f=b/2,g=Math.floor(c)||1,h=Math.floor(d)||1,i=g+1,j=h+1,k=a/g,l=b/h,m=new Float32Array(i*j*3),n=new Float32Array(i*j*3),o=new Float32Array(i*j*2),p=0,q=0,r=0;j>r;r++)for(var s=r*l-f,t=0;i>t;t++){var u=t*k-e;m[p]=u,m[p+1]=-s,n[p+2]=1,o[q]=t/g,o[q+1]=1-r/h,p+=3,q+=2}p=0;for(var v=new(m.length/3>65535?Uint32Array:Uint16Array)(g*h*6),r=0;h>r;r++)for(var t=0;g>t;t++){var w=t+i*r,x=t+i*(r+1),y=t+1+i*(r+1),z=t+1+i*r;v[p]=w,v[p+1]=x,v[p+2]=z,v[p+3]=x,v[p+4]=y,v[p+5]=z,p+=6}this.setIndex(new THREE.BufferAttribute(v,1)),this.addAttribute("position",new THREE.BufferAttribute(m,3)),this.addAttribute("normal",new THREE.BufferAttribute(n,3)),this.addAttribute("uv",new THREE.BufferAttribute(o,2))},THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry,THREE.PlaneBufferGeometry.prototype.clone=function(){var a=new THREE.PlaneBufferGeometry(this.parameters.width,this.parameters.height,this.parameters.widthSegments,this.parameters.heightSegments);return a.copy(this),a},THREE.SphereBufferGeometry=function(a,b,c,d,e,f,g){THREE.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g},a=a||50,b=Math.max(3,Math.floor(b)||8),c=Math.max(2,Math.floor(c)||6),d=void 0!==d?d:0,e=void 0!==e?e:2*Math.PI,f=void 0!==f?f:0,g=void 0!==g?g:Math.PI;for(var h=f+g,i=(b+1)*(c+1),j=new THREE.BufferAttribute(new Float32Array(3*i),3),k=new THREE.BufferAttribute(new Float32Array(3*i),3),l=new THREE.BufferAttribute(new Float32Array(2*i),2),m=0,n=[],o=new THREE.Vector3,p=0;c>=p;p++){for(var q=[],r=p/c,s=0;b>=s;s++){var t=s/b,u=-a*Math.cos(d+t*e)*Math.sin(f+r*g),v=a*Math.cos(f+r*g),w=a*Math.sin(d+t*e)*Math.sin(f+r*g);o.set(u,v,w).normalize(),j.setXYZ(m,u,v,w),k.setXYZ(m,o.x,o.y,o.z),l.setXY(m,t,1-r),q.push(m),m++}n.push(q)}for(var x=[],p=0;c>p;p++)for(var s=0;b>s;s++){var y=n[p][s+1],z=n[p][s],A=n[p+1][s],B=n[p+1][s+1];(0!==p||f>0)&&x.push(y,z,B),(p!==c-1||h<Math.PI)&&x.push(z,A,B)}this.setIndex(new THREE.BufferAttribute(new Uint16Array(x),1)),this.addAttribute("position",j),this.addAttribute("normal",k),this.addAttribute("uv",l),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)},THREE.SphereBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype),THREE.SphereBufferGeometry.prototype.constructor=THREE.SphereBufferGeometry,THREE.SphereBufferGeometry.prototype.clone=function(){var a=new THREE.SphereBufferGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength);return a.copy(this),a},THREE.BasicShader={uniforms:{},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["void main() {","gl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );","}"].join("\n")},THREE.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},THREE.ConvolutionShader={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{type:"t",value:null},uImageIncrement:{type:"v2",value:new THREE.Vector2(.001953125,0)},cKernel:{type:"fv1",value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vec2 imageCoord = vUv;","vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","imageCoord += uImageIncrement;","}","gl_FragColor = sum;","}"].join("\n"),buildKernel:function(a){function b(a,b){return Math.exp(-(a*a)/(2*b*b))}var c,d,e,f,g=25,h=2*Math.ceil(3*a)+1;for(h>g&&(h=g),f=.5*(h-1),d=new Array(h),e=0,c=0;h>c;++c)d[c]=b(c-f,a),e+=d[c];for(c=0;h>c;++c)d[c]/=e;return d}},THREE.VignetteShader={uniforms:{tDiffuse:{type:"t",value:null},offset:{type:"f",value:1},darkness:{type:"f",value:1},color:{type:"c",value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float offset;","uniform float darkness;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ) * color, dot( uv, uv ) ), texel.a );","}"].join("\n")},THREE.EffectComposer=function(a,b){if(this.renderer=a,void 0===b){var c=window.innerWidth||1,d=window.innerHeight||1,e={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1};b=new THREE.WebGLRenderTarget(c,d,e)}this.renderTarget1=b,this.renderTarget2=b.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader)},THREE.EffectComposer.prototype={swapBuffers:function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=a},addPass:function(a){this.passes.push(a)},insertPass:function(a,b){this.passes.splice(b,0,a)},render:function(a){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var b,c,d=!1,e=this.passes.length;for(c=0;e>c;c++)if(b=this.passes[c],b.enabled){if(b.render(this.renderer,this.writeBuffer,this.readBuffer,a,d),b.needsSwap){if(d){var f=this.renderer.context;f.stencilFunc(f.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,a),f.stencilFunc(f.EQUAL,1,4294967295)}this.swapBuffers()}b instanceof THREE.MaskPass?d=!0:b instanceof THREE.ClearMaskPass&&(d=!1)}},reset:function(a){void 0===a&&(a=this.renderTarget1.clone(),a.width=window.innerWidth,a.height=window.innerHeight),this.renderTarget1=a,this.renderTarget2=a.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(a,b){var c=this.renderTarget1.clone();c.width=a,c.height=b,this.reset(c)}},THREE.RenderPass=function(a,b,c,d,e){this.scene=a,this.camera=b,this.overrideMaterial=c,this.clearColor=d,this.clearAlpha=void 0!==e?e:1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.enabled=!0,this.clear=!0,this.needsSwap=!1},THREE.RenderPass.prototype={render:function(a,b,c,d){this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(this.oldClearColor.copy(a.getClearColor()),this.oldClearAlpha=a.getClearAlpha(),a.setClearColor(this.clearColor,this.clearAlpha)),a.render(this.scene,this.camera,c,this.clear),this.clearColor&&a.setClearColor(this.oldClearColor,this.oldClearAlpha),this.scene.overrideMaterial=null}},THREE.SavePass=function(a){void 0===THREE.CopyShader&&console.error("THREE.SavePass relies on THREE.CopyShader");var b=THREE.CopyShader;this.textureID="tDiffuse",this.uniforms=THREE.UniformsUtils.clone(b.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader}),this.renderTarget=a,void 0===this.renderTarget&&(this.renderTargetParameters={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1},this.renderTarget=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,this.renderTargetParameters)),this.enabled=!0,this.needsSwap=!1,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},THREE.SavePass.prototype={render:function(a,b,c,d){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c),this.quad.material=this.material,a.render(this.scene,this.camera,this.renderTarget,this.clear)}},THREE.ShaderPass=function(a,b){this.textureID=void 0!==b?b:"tDiffuse",this.uniforms=THREE.UniformsUtils.clone(a.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}),this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},THREE.ShaderPass.prototype={render:function(a,b,c,d){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c),this.quad.material=this.material,this.renderToScreen?a.render(this.scene,this.camera):a.render(this.scene,this.camera,b,this.clear)}},THREE.TexturePass=function(a,b){void 0===THREE.CopyShader&&console.error("THREE.TexturePass relies on THREE.CopyShader");var c=THREE.CopyShader;this.uniforms=THREE.UniformsUtils.clone(c.uniforms),this.uniforms.opacity.value=void 0!==b?b:1,this.uniforms.tDiffuse.value=a,this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}),this.enabled=!0,this.needsSwap=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},THREE.TexturePass.prototype={render:function(a,b,c,d){this.quad.material=this.material,a.render(this.scene,this.camera,c)}},THREE.MaskPass=function(a,b){this.scene=a,this.camera=b,this.enabled=!0,this.clear=!0,this.needsSwap=!1,this.inverse=!1},THREE.MaskPass.prototype={render:function(a,b,c,d){var e=a.context;e.colorMask(!1,!1,!1,!1),e.depthMask(!1);var f,g;this.inverse?(f=0,g=1):(f=1,g=0),e.enable(e.STENCIL_TEST),e.stencilOp(e.REPLACE,e.REPLACE,e.REPLACE),e.stencilFunc(e.ALWAYS,f,4294967295),e.clearStencil(g),a.render(this.scene,this.camera,c,this.clear),a.render(this.scene,this.camera,b,this.clear),e.colorMask(!0,!0,!0,!0),e.depthMask(!0),e.stencilFunc(e.EQUAL,1,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}},THREE.ClearMaskPass=function(){this.enabled=!0},THREE.ClearMaskPass.prototype={render:function(a,b,c,d){var e=a.context;e.disable(e.STENCIL_TEST)}},THREE.BloomPass=function(a,b,c,d){a=void 0!==a?a:1,b=void 0!==b?b:25,c=void 0!==c?c:4,d=void 0!==d?d:256;var e={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat};this.renderTargetX=new THREE.WebGLRenderTarget(d,d,e),this.renderTargetY=new THREE.WebGLRenderTarget(d,d,e),void 0===THREE.CopyShader&&console.error("THREE.BloomPass relies on THREE.CopyShader");var f=THREE.CopyShader;this.copyUniforms=THREE.UniformsUtils.clone(f.uniforms),this.copyUniforms.opacity.value=a,this.materialCopy=new THREE.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,blending:THREE.AdditiveBlending,transparent:!0}),void 0===THREE.ConvolutionShader&&console.error("THREE.BloomPass relies on THREE.ConvolutionShader");var g=THREE.ConvolutionShader;this.convolutionUniforms=THREE.UniformsUtils.clone(g.uniforms),this.convolutionUniforms.uImageIncrement.value=THREE.BloomPass.blurx,this.convolutionUniforms.cKernel.value=THREE.ConvolutionShader.buildKernel(c),this.materialConvolution=new THREE.ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader,defines:{KERNEL_SIZE_FLOAT:b.toFixed(1),KERNEL_SIZE_INT:b.toFixed(0)}}),this.enabled=!0,this.needsSwap=!1,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},THREE.BloomPass.prototype={render:function(a,b,c,d,e){e&&a.context.disable(a.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=c,this.convolutionUniforms.uImageIncrement.value=THREE.BloomPass.blurX,a.render(this.scene,this.camera,this.renderTargetX,!0),this.convolutionUniforms.tDiffuse.value=this.renderTargetX,this.convolutionUniforms.uImageIncrement.value=THREE.BloomPass.blurY,a.render(this.scene,this.camera,this.renderTargetY,!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY,e&&a.context.enable(a.context.STENCIL_TEST),a.render(this.scene,this.camera,c,this.clear)}},THREE.BloomPass.blurX=new THREE.Vector2(.001953125,0),THREE.BloomPass.blurY=new THREE.Vector2(0,.001953125),THREE.ShaderChunk.lerp_pos_pars_vertex=["uniform float stepProgress;","attribute vec3 positionPrev;"].join("\n"),THREE.ShaderChunk.lerp_pos_vertex=["vec4 mvPosition = modelViewMatrix * vec4(mix(positionPrev, position, stepProgress), 1.0);","gl_Position = projectionMatrix * mvPosition;"].join("\n"),this.App=this.App||{},this.App.shaders=this.App.shaders||{},this.App.shaders["alpha-frag"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return"uniform vec3 diffuse;\nuniform float opacity;\nvarying float vAlpha;\n\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.map_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_pars_fragment:f,b))?f:"")+"\n\nvoid main() {\n  vec3 outgoingLight = vec3(0.0);\n  vec4 diffuseColor = vec4(diffuse, opacity * vAlpha);\n  vec3 totalAmbientLight = vec3(1.0); // hardwired\n  vec3 shadowMask = vec3(1.0);\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.map_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.alphatest_fragment:f,b))?f:"")+"\n\n  outgoingLight = diffuseColor.rgb * totalAmbientLight;\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.linear_to_gamma_fragment:f,b))?f:"")+"\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n}\n"},useData:!0}),this.App.shaders["alpha-vert"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_pars_vertex:f,b))?f:"")+"\n\nattribute float alpha;\nvarying float vAlpha;\n\nvoid main() {\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_vertex:f,b))?f:"")+"\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.begin_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.project_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_vertex:f,b))?f:"")+"\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.worldpos_vertex:f,b))?f:"")+"\n\n  vAlpha = alpha;\n}\n"},useData:!0}),this.App.shaders["basic-frag"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return"uniform vec3 diffuse;\nuniform float opacity;\n\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv2_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.map_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.alphamap_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.aomap_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.envmap_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.fog_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.shadowmap_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.specularmap_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_pars_fragment:f,b))?f:"")+"\n\nvoid main() {\n  vec3 outgoingLight = vec3(0.0);\n  vec4 diffuseColor = vec4(diffuse, opacity);\n  vec3 totalAmbientLight = vec3(1.0);\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.map_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.alphamap_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.alphatest_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.specularmap_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.aomap_fragment:f,b))?f:"")+"\n\n  outgoingLight = diffuseColor.rgb * totalAmbientLight;\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.envmap_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.shadowmap_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.linear_to_gamma_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.fog_fragment:f,b))?f:"")+"\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n}\n"},useData:!0}),this.App.shaders["basic-point-frag"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return"uniform vec3 psColor;\nuniform float opacity;\n\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.map_particle_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.fog_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.shadowmap_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_pars_fragment:f,b))?f:"")+"\n\nvoid main() {\n  vec3 outgoingLight = vec3(0.0);\n  vec4 diffuseColor = vec4(psColor, opacity);\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.map_particle_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.alphatest_fragment:f,b))?f:"")+"\n\n  outgoingLight = diffuseColor.rgb;\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.shadowmap_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.fog_fragment:f,b))?f:"")+"\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n}\n"},useData:!0}),this.App.shaders["basic-vert"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv2_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.envmap_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.morphtarget_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.skinning_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.shadowmap_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_pars_vertex:f,b))?f:"")+"\n\nvoid main() {\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv2_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.skinbase_vertex:f,b))?f:"")+"\n\n  #ifdef USE_ENVMAP\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.beginnormal_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.morphnormal_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.skinnormal_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.defaultnormal_vertex:f,b))?f:"")+"\n  #endif\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.begin_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.morphtarget_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.skinning_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.project_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_vertex:f,b))?f:"")+"\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.worldpos_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.envmap_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.shadowmap_vertex:f,b))?f:"")+"\n}\n"},useData:!0}),this.App.shaders["bulb-frag"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"uniform vec3 diffuse;\nuniform vec3 diffuseB;\nuniform float opacity;\nuniform float time;\nvarying vec2 vUv;\nvarying vec3 vNormal;\n\nconst vec3 eye = vec3(0.0, 0.0, 1.0);\n\nfloat oscillate(float vMin, float vMax, float t) {\n  float halfRange = (vMax - vMin) / vMax * 0.5;\n  return (sin(t) * halfRange + (1.0 - halfRange)) * vMax;\n}\n\nfloat accumulate(vec2 uv, float saturation, float scale) {\n  saturation -= sin(uv.x * 60.0) * 0.25 + sin(uv.x * 50.0 * scale) * 0.25 + 0.75;\n\n  saturation -= sin(uv.y * sin(uv.x         * 5.0) * 5.0 * scale) * 0.05;\n  saturation -= sin(uv.y * sin((1.0 - uv.x) * 5.0) * 5.0 * scale) * 0.05;\n\n  saturation -= sin(uv.y * sin(uv.y + cos(uv.x)       * 2.0) * 3.0 * scale) * 0.15;\n  saturation -= sin(uv.y * sin(uv.y + cos(1.0 - uv.x) * 2.0) * 3.0 * scale) * 0.15;\n\n  saturation -= sin((uv.y - 1.5) * sin(uv.y + cos(uv.x - 1.0) * 2.0) * 4.0 * scale) * 0.15;\n  saturation -= sin((uv.y - 1.5) * sin(uv.y + cos(uv.x)       * 2.0) * 3.0 * scale) * 0.15;\n\n  saturation -= sin(uv.y * 5.0) * 0.15 + sin(uv.y * 2.5) * 1.25;\n\n  return saturation;\n}\n\nvoid main() {\n  vec3 normal = normalize(mat3(viewMatrix) * vNormal);\n  float rim = 1.0 - max(dot(eye, normal), 0.0);\n  float saturation = 0.0;\n\n  vec2 uv0 = vUv;\n  vec2 uv1 = uv0 + rim;\n  vec2 uv2 = vec2(-rim * 0.25);\n  vec2 uv3 = vec2(rim, uv0.y);\n\n  float scale0 = oscillate( 8.0, 15.0, time * 0.25 + 0.5);\n  float scale1 = oscillate(12.0, 20.0, time * 0.125);\n  float scale2 = 1.0;\n  float scale3 = 1.0;\n\n  saturation += max(accumulate(uv0, 2.0, scale0), -0.5);\n  saturation += max(accumulate(uv1, 2.0, scale1),  0.25);\n  saturation += max(accumulate(uv2, 1.0, scale2), -0.25);\n  saturation += max(accumulate(uv3, 1.0, scale3), -0.25);\n\n  gl_FragColor = vec4(\n    mix(diffuse, diffuseB, smoothstep(-0.5, 0.5, saturation)),\n    (1.0 - smoothstep(-0.5, 2.5, saturation)) * opacity);\n}\n"},useData:!0}),this.App.shaders["dust-frag"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return"uniform vec3 psColor;\nuniform float opacity;\nuniform float area;\nvarying float centerDist;\n\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_fragment:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.map_particle_pars_fragment:f,b))?f:"")+"\n\nvoid main() {\n  vec4 diffuseColor = vec4(psColor, opacity);\n  float radius = area * 0.5;\n  float illumination = max(0.0, (radius - centerDist) / radius);\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.map_particle_fragment:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_fragment:f,b))?f:"")+"\n\n  gl_FragColor = vec4(diffuseColor.rgb,\n    illumination * illumination * diffuseColor.a);\n}\n"},useData:!0}),this.App.shaders["dust-vert"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"uniform float size;\nuniform float scale;\nuniform float time;\nuniform float area;\nvarying float centerDist;\n\nvoid main() {\n  float offsetY = mod(position.y - 1.0 * time, area) - area * 0.5;\n  vec3 offsetPosition = vec3(\n    position.x + sin(cos(offsetY * 0.1) + sin(offsetY * 0.1 + position.x * 0.1) * 2.0),\n    offsetY,\n    position.z + sin(cos(offsetY * 0.1) + sin(offsetY * 0.1 + position.z * 0.1) * 2.0));\n\n  centerDist = length(offsetPosition);\n\n  vec4 mvPosition = modelViewMatrix * vec4(offsetPosition, 1.0);\n\n  gl_PointSize = size * (scale / length(mvPosition.xyz));\n  gl_Position = projectionMatrix * mvPosition;\n}\n";
},useData:!0}),this.App.shaders["gel-frag"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"uniform vec3 diffuse;\nuniform float opacity;\nvarying vec3 vNormal;\n\nvoid main() {\n  vec3 eye = vec3(0.0, 0.0, 1.0);\n  vec3 normal = normalize(mat3(viewMatrix) * vNormal);\n  float rim = 1.0 - max(dot(eye, normal), 0.0);\n\n  float rimLight = 0.25 +\n    smoothstep(0.25, 1.0, rim) * 0.5 +\n    smoothstep(0.90, 1.0, rim) * 0.8;\n\n  gl_FragColor.rgb = diffuse * vec3(rimLight);\n  gl_FragColor.a = opacity;\n}\n"},useData:!0}),this.App.shaders["gel-vert"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.lerp_pos_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_vertex:f,b))?f:"")+"\n\nvarying vec3 vNormal;\n\nvoid main() {\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.lerp_pos_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.worldpos_vertex:f,b))?f:"")+"\n\n  vNormal = normalize(position);\n}\n"},useData:!0}),this.App.shaders["lerp-point-vert"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return"uniform float size;\nuniform float scale;\n\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.lerp_pos_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_pars_vertex:f,b))?f:"")+"\n\nvoid main() {\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.lerp_pos_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_vertex:f,b))?f:"")+"\n\n  #ifdef USE_SIZEATTENUATION\n    gl_PointSize = size * (scale / length(mvPosition.xyz));\n  #else\n    gl_PointSize = size;\n  #endif\n}\n"},useData:!0}),this.App.shaders["lerp-vert"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv2_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.lerp_pos_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_pars_vertex:f,b))?f:"")+"\n\nvoid main() {\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv2_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_vertex:f,b))?f:"")+"\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.begin_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.lerp_pos_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.worldpos_vertex:f,b))?f:"")+"\n}\n"},useData:!0}),this.App.shaders["normal-vert"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv2_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.lerp_pos_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_pars_vertex:f,b))?f:"")+"\n\nvarying vec3 vNormal;\n\nvoid main() {\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.uv2_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_vertex:f,b))?f:"")+"\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.begin_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.lerp_pos_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.logdepthbuf_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.worldpos_vertex:f,b))?f:"")+"\n\n  vNormal = normalize(position);\n}\n"},useData:!0}),this.App.shaders["tail-frag"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"uniform vec3 diffuse;\nuniform vec3 diffuseB;\nuniform float opacity;\nuniform float scale;\nvarying vec2 vUv;\nvarying vec3 vNormal;\n\nconst vec3 eye = vec3(0.0, 0.0, 1.0);\n\nfloat accumulate(vec2 uv, float saturation, float scale) {\n  saturation -= sin(uv.y * 12.0 * scale) * 0.8 + uv.y * 1.5 + sin(uv.x * 20.0 * scale) * 0.1 + 0.85;\n\n  saturation -= sin(uv.y * sin(uv.x         * 5.0) * 5.0 * scale) * 0.05;\n  saturation -= sin(uv.y * sin((1.0 - uv.x) * 5.0) * 5.0 * scale) * 0.05;\n\n  saturation -= sin(uv.y * sin(uv.y + cos(uv.x)       * 2.0) * 10.0 * scale) * 0.15;\n  saturation -= sin(uv.y * sin(uv.y + cos(1.0 - uv.x) * 2.0) * 10.0 * scale) * 0.15;\n\n  return saturation;\n}\n\nvoid main() {\n  vec2 uv = vUv;\n  vec3 normal = normalize(mat3(viewMatrix) * vNormal);\n  float rim = 1.0 - max(dot(eye, normal), 0.0);\n  float saturation = 0.0;\n\n  saturation += accumulate(uv, 2.0, scale);\n  saturation += max(accumulate(vec2(rim), 0.75, scale * 0.25), -0.25);\n\n  gl_FragColor = vec4(\n    mix(diffuseB, diffuse, saturation) * opacity,\n    clamp(saturation, 0.2, 1.0) * opacity);\n}\n"},useData:!0}),this.App.shaders["tentacle-frag"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"uniform vec3 diffuse;\nuniform float opacity;\nuniform float area;\nvarying float centerDist;\n\nvoid main() {\n  float illumination = area * 2.0 / (centerDist * centerDist);\n  gl_FragColor = vec4(\n    mix(vec3(1.0), diffuse, clamp(illumination, 0.0, 1.25)),\n    clamp(opacity * illumination * illumination, 0.0, opacity));\n}\n"},useData:!0}),this.App.shaders["tentacle-vert"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return"uniform float area;\nvarying float centerDist;\n\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.lerp_pos_pars_vertex:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_pars_vertex:f,b))?f:"")+"\n\nvoid main() {\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.color_vertex:f,b))?f:"")+"\n\n  centerDist = length(position);\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.lerp_pos_vertex:f,b))?f:"")+"\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.worldpos_vertex:f,b))?f:"")+"\n}\n"},useData:!0}),this.App.shaders["uvs-frag"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=a.lambda;return"uniform vec3 diffuse;\nuniform float opacity;\n\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.common:f,b))?f:"")+"\n"+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.map_pars_fragment:f,b))?f:"")+"\n\nvoid main() {\n  vec4 diffuseColor = vec4(diffuse, opacity);\n\n  "+(null!=(f=g(null!=(f=null!=b?b.chunks:b)?f.map_fragment:f,b))?f:"")+"\n\n  gl_FragColor = vec4(vUv.xy, 0.0, opacity);\n}\n"},useData:!0}),function(){window.App=Object.create({ctor:Particulate.ctor,log:window.console&&window.console.log.bind&&window.console.log.bind(window.console)||function(){},shaders:window.App&&window.App.shaders,_register:{},register:function(a,b){this._register[a]=b},run:function(a){this._register[a]&&this._register[a].call(this)}})}(),function(){function a(a,b,c){var d=this._listeners;d||(d=this._listeners={}),d[a]||(d[a]=[]),d[a].push({context:b,fn:c})}function b(a,b){var c=this._listeners&&this._listeners[a];if(c)for(var d,e,f,g=0,h=c.length;h>g;g++)d=c[g],e=d.context,f=d.fn,"function"==typeof e?(f=e,e=null):"string"==typeof f&&(f=e[f]),f.call(e,b)}var c=App.Dispatcher={};c.extend=function(c){c.addListener=a,c.triggerListeners=b}}(),function(){var a=App.Faces={};a.quad=function(a,b,c,d,e){return e.push(a,b,c,c,d,a),e},a.quadDoubleSide=function(a,b,c,d,e){return e.push(a,b,c,c,d,a,d,c,b,b,a,d),e},a.radial=function(a,b,c,d){for(var e,f,g=0,h=c-1;h>g;g++)e=b+g+1,f=b+g,d.push(a,e,f);return e=b,f=b+c-1,d.push(a,e,f),d},a.rings=function(a,b,c,d){for(var e,f,g,h,i=0,j=c-1;j>i;i++)e=a+i,f=a+i+1,g=b+i+1,h=b+i,d.push(e,f,g,g,h,e);return e=a+c-1,f=a,g=b,h=b+c-1,d.push(e,f,g,g,h,e),d}}(),function(){var a=App.Features={};a.detectWebAudio=function(){return new Promise(function(a,b){var c="webkitAudioContext"in window,d="AudioContext"in window;c||d?a():b()})},a.detectAudioCodecs=function(a){return new Promise(function(b,c){var d=new Audio,e=a.find(function(a){return!!d.canPlayType(a).replace(/^no$/,"")});e?b():c()})},a.detectAudioAutoplay=function(){return new Promise(function(a,b){var c="data:audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",d="data:audio/ogg;base64,T2dnUwACAAAAAAAAAADqnjMlAAAAAOyyzPIBHgF2b3JiaXMAAAAAAUAfAABAHwAAQB8AAEAfAACZAU9nZ1MAAAAAAAAAAAAA6p4zJQEAAAANJGeqCj3//////////5ADdm9yYmlzLQAAAFhpcGguT3JnIGxpYlZvcmJpcyBJIDIwMTAxMTAxIChTY2hhdWZlbnVnZ2V0KQAAAAABBXZvcmJpcw9CQ1YBAAABAAxSFCElGVNKYwiVUlIpBR1jUFtHHWPUOUYhZBBTiEkZpXtPKpVYSsgRUlgpRR1TTFNJlVKWKUUdYxRTSCFT1jFloXMUS4ZJCSVsTa50FkvomWOWMUYdY85aSp1j1jFFHWNSUkmhcxg6ZiVkFDpGxehifDA6laJCKL7H3lLpLYWKW4q91xpT6y2EGEtpwQhhc+211dxKasUYY4wxxsXiUyiC0JBVAAABAABABAFCQ1YBAAoAAMJQDEVRgNCQVQBABgCAABRFcRTHcRxHkiTLAkJDVgEAQAAAAgAAKI7hKJIjSZJkWZZlWZameZaouaov+64u667t6roOhIasBACAAAAYRqF1TCqDEEPKQ4QUY9AzoxBDDEzGHGNONKQMMogzxZAyiFssLqgQBKEhKwKAKAAAwBjEGGIMOeekZFIi55iUTkoDnaPUUcoolRRLjBmlEluJMYLOUeooZZRCjKXFjFKJscRUAABAgAMAQICFUGjIigAgCgCAMAYphZRCjCnmFHOIMeUcgwwxxiBkzinoGJNOSuWck85JiRhjzjEHlXNOSuekctBJyaQTAAAQ4AAAEGAhFBqyIgCIEwAwSJKmWZomipamiaJniqrqiaKqWp5nmp5pqqpnmqpqqqrrmqrqypbnmaZnmqrqmaaqiqbquqaquq6nqrZsuqoum65q267s+rZru77uqapsm6or66bqyrrqyrbuurbtS56nqqKquq5nqq6ruq5uq65r25pqyq6purJtuq4tu7Js664s67pmqq5suqotm64s667s2rYqy7ovuq5uq7Ks+6os+75s67ru2rrwi65r66os674qy74x27bwy7ouHJMnqqqnqq7rmarrqq5r26rr2rqmmq5suq4tm6or26os67Yry7aumaosm64r26bryrIqy77vyrJui67r66Ys67oqy8Lu6roxzLat+6Lr6roqy7qvyrKuu7ru+7JuC7umqrpuyrKvm7Ks+7auC8us27oxuq7vq7It/KosC7+u+8Iy6z5jdF1fV21ZGFbZ9n3d95Vj1nVhWW1b+V1bZ7y+bgy7bvzKrQvLstq2scy6rSyvrxvDLux8W/iVmqratum6um7Ksq/Lui60dd1XRtf1fdW2fV+VZd+3hV9pG8OwjK6r+6os68Jry8ov67qw7MIvLKttK7+r68ow27qw3L6wLL/uC8uq277v6rrStXVluX2fsSu38QsAABhwAAAIMKEMFBqyIgCIEwBAEHIOKQahYgpCCKGkEEIqFWNSMuakZM5JKaWUFEpJrWJMSuaclMwxKaGUlkopqYRSWiqlxBRKaS2l1mJKqcVQSmulpNZKSa2llGJMrcUYMSYlc05K5pyUklJrJZXWMucoZQ5K6iCklEoqraTUYuacpA46Kx2E1EoqMZWUYgupxFZKaq2kFGMrMdXUWo4hpRhLSrGVlFptMdXWWqs1YkxK5pyUzDkqJaXWSiqtZc5J6iC01DkoqaTUYiopxco5SR2ElDLIqJSUWiupxBJSia20FGMpqcXUYq4pxRZDSS2WlFosqcTWYoy1tVRTJ6XFklKMJZUYW6y5ttZqDKXEVkqLsaSUW2sx1xZjjqGkFksrsZWUWmy15dhayzW1VGNKrdYWY40x5ZRrrT2n1mJNMdXaWqy51ZZbzLXnTkprpZQWS0oxttZijTHmHEppraQUWykpxtZara3FXEMpsZXSWiypxNhirLXFVmNqrcYWW62ltVprrb3GVlsurdXcYqw9tZRrrLXmWFNtBQAADDgAAASYUAYKDVkJAEQBAADGMMYYhEYpx5yT0ijlnHNSKucghJBS5hyEEFLKnINQSkuZcxBKSSmUklJqrYVSUmqttQIAAAocAAACbNCUWByg0JCVAEAqAIDBcTRNFFXVdX1fsSxRVFXXlW3jVyxNFFVVdm1b+DVRVFXXtW3bFn5NFFVVdmXZtoWiqrqybduybgvDqKqua9uybeuorqvbuq3bui9UXVmWbVu3dR3XtnXd9nVd+Bmzbeu2buu+8CMMR9/4IeTj+3RCCAAAT3AAACqwYXWEk6KxwEJDVgIAGQAAgDFKGYUYM0gxphhjTDHGmAAAgAEHAIAAE8pAoSErAoAoAADAOeecc84555xzzjnnnHPOOeecc44xxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY0wAwE6EA8BOhIVQaMhKACAcAABACCEpKaWUUkoRU85BSSmllFKqFIOMSkoppZRSpBR1lFJKKaWUIqWgpJJSSimllElJKaWUUkoppYw6SimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaVUSimllFJKKaWUUkoppRQAYPLgAACVYOMMK0lnhaPBhYasBAByAwAAhRiDEEJpraRUUkolVc5BKCWUlEpKKZWUUqqYgxBKKqmlklJKKbXSQSihlFBKKSWUUkooJYQQSgmhlFRCK6mEUkoHoYQSQimhhFRKKSWUzkEoIYUOQkmllNRCSB10VFIpIZVSSiklpZQ6CKGUklJLLZVSWkqpdBJSKamV1FJqqbWSUgmhpFZKSSWl0lpJJbUSSkklpZRSSymFVFJJJYSSUioltZZaSqm11lJIqZWUUkqppdRSSiWlkEpKqZSSUmollZRSaiGVlEpJKaTUSimlpFRCSamlUlpKLbWUSkmptFRSSaWUlEpJKaVSSksppRJKSqmllFpJKYWSUkoplZJSSyW1VEoKJaWUUkmptJRSSymVklIBAEAHDgAAAUZUWoidZlx5BI4oZJiAAgAAQABAgAkgMEBQMApBgDACAQAAAADAAAAfAABHARAR0ZzBAUKCwgJDg8MDAAAAAAAAAAAAAACAT2dnUwAEAAAAAAAAAADqnjMlAgAAADzQPmcBAQA=",e=new Audio,f=e.canPlayType("audio/ogg")?d:c;e.autoplay=!0,e.volume=0;var g=setTimeout(b,20);e.addEventListener("play",function(){clearTimeout(g),a()},!1),e.src=f,e.play()})},a.detectInputType=function(a){return new Promise(function(b,c){var d=document.createElement("input");d.setAttribute("type",a),d.type===a?b():c()})}}(),function(){var a=App.Format={};a.number=function(a){for(var b,c=(""+a).split(""),d="",e=0,f=c.length;f>e;e++)b=f-e-1,d+=c[e],b%3===0&&b>0&&(d+=",");return d},a.absoluteLength=function(a,b){for(a=""+a;a.length<b;)a="0"+a;return a}}(),function(){var a=App.Geometry={};a.point=function(a,b,c,d){return d.push(a,b,c),d},a.circle=function(a,b,c,d){for(var e,f,g=2*Math.PI/a,h=0,i=0;a>i;i++)e=Math.cos(h)*b,f=Math.sin(h)*b,d.push(e,c,f),h+=g;return d}}(),function(){function a(){this._bindings={},document.addEventListener("keyup",this.onDocumentKey.bind(this),!1)}App.KeyDelegator=a,a.create=App.ctor(a),a.prototype.addBinding=function(a,b,c){this._bindings[a]={context:b,fn:c}},a.prototype.onDocumentKey=function(a){var b=this._bindings[a.which];b&&b.context[b.fn].call(b.context,a)}}(),function(){var a=App.Links={};a.line=function(a,b,c){for(var d,e,f=0;b-1>f;f++)d=a+f,e=a+f+1,c.push(d,e);return c},a.loop=function(a,b,c){for(var d,e,f=0;b-1>f;f++)d=a+f,e=a+f+1,c.push(d,e);return d=a,e=a+b-1,c.push(d,e),c},a.rings=function(a,b,c,d){for(var e,f,g=0;c>g;g++)e=a+g,f=b+g,d.push(e,f);return d},a.radial=function(a,b,c,d){for(var e,f=0;c>f;f++)e=b+f,d.push(a,e);return d}}(),function(){function a(a,b,c,d){function e(b){k+=b;var c=Math.floor(k/l);for(c>0&&(k-=c*l,h.didUpdate=!0);c>0;)i.call(a,l),c--;var d=k/l;j.call(a,l,d)}function f(){if(n){var a=Date.now(),b=Math.min(m,a-g);h.didUpdate=!1,e(b),requestAnimationFrame(f),g=a}}var g,h=this,i=a[b],j=a[c],k=0,l=d||1/30*1e3,m=l,n=!1;this.stop=function(){n=!1},this.start=function(){g=Date.now(),n=!0,f()},this.toggle=function(){n?this.stop():this.start()}}App.Looper=a,a.create=App.ctor(a)}(),function(){var a=App.Tweens={};a.mapRange=function(a,b,c,d){2===arguments.length&&(d=b[1],c=b[0],b=a[1],a=a[0]);var e=1/(b-a),f=d-c;return function(b){var d=(b-a)*e;return c+d*f}},a.factorTween=function(a,b){return function(c,d,e){var f=a[c];null==f&&(f=a[c]=d);var g=e||b;return a[c]+=(d-f)*g}},a.stepTween=function(a,b){return function(c,d,e){var f=a[c];if(null==f&&(f=a[c]=d),f===d)return f;var g=e||b,h=d>f?1:-1;return g>(d-f)*h?(a[c]=d,f):a[c]+=g*h}}}(),function(){function a(a){a=a||{};var b=this.element=document.createElement("div"),c=this._input=document.createElement("input"),d=this._previewEl=document.createElement("div"),e=this._labelEl=document.createElement("div");this.color=a.color||new THREE.Color,this.setLabel(a.label||""),this.setValue(),this.syncState(),b.className=this._className="color",d.className="preview",e.className="label",c.setAttribute("type","color"),b.appendChild(d),b.appendChild(e),b.appendChild(c),c.addEventListener("change",this.syncState.bind(this),!1),c.addEventListener("focus",this.focus.bind(this),!1),c.addEventListener("blur",this.blur.bind(this),!1)}App.ColorComponent=a,a.create=App.ctor(a),App.Dispatcher.extend(a.prototype),a.prototype.setLabel=function(a){this._labelEl.textContent=a},a.prototype.setValue=function(a){a=a||"#"+this.color.getHexString(),this._input.setAttribute("value",a)},a.prototype.focus=function(a){this.element.className=this._className+" focus"},a.prototype.blur=function(a){this.element.className=this._className},a.prototype.syncState=function(a){var b=this._input.value;this._previewEl.style.background=b,this.color.setStyle(b),this.triggerListeners("change",b)}}(),function(){function a(a){a=a||{},this.max=0,this.current=0,this.updateFactor=a.updateFactor||.1,this.drawOffset=a.drawOffset||2,this.pxRatio=a.pixelRatio||window.devicePixelRatio,this.createBuffers(),this.setSize(a.width||380,a.height||24),this.createLineBuffer(),this.createElement(),this.setLabel(a.label||"")}App.GraphComponent=a,a.create=App.ctor(a),a.prototype.setSize=function(a,b){var c=this.pxRatio;this.width=a,this.height=b,this.fullWidth=a*c,this.fullHeight=b*c,this.canvas.width=this.buffer.width=this.fullWidth,this.canvas.height=this.buffer.height=this.fullHeight,this.canvas.style.width=a+"px",this.canvas.style.height=b+"px"},a.prototype.appendTo=function(a){a.appendChild(this.element)},a.prototype.createElement=function(){var a=this.element=document.createElement("div"),b=document.createElement("div"),c=this._labelEl=document.createTextNode(""),d=this._valueEl=document.createTextNode(""),e=this.canvas;a.className="graph",b.className="label",a.appendChild(e),a.appendChild(b),b.appendChild(c),b.appendChild(d)},a.prototype.setLabel=function(a){this._labelEl.textContent=a+" "},a.prototype.createBuffers=function(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.buffer=document.createElement("canvas"),this.btx=this.buffer.getContext("2d")},a.prototype.grayscale=function(a,b){return"rgba("+[a,a,a,b].join(",")+")"},a.prototype.createLineBuffer=function(){var a=this.fullHeight,b=this.pxRatio,c=document.createElement("canvas"),d=c.getContext("2d");c.width=b,c.height=2*a+10,d.fillStyle=this.grayscale(255,.7),d.fillRect(0,a,b,b),d.fillStyle=this.grayscale(255,.1),d.fillRect(0,a+2*b,b,a+10),this.line=c},a.prototype.start=function(){this._startTime=Date.now()},a.prototype.end=function(){this._endTime=Date.now()},a.prototype.reset=function(){this._startTime=this._endTime=0},a.prototype._startTime=0,a.prototype._endTime=0,a.prototype._textTick=0,a.prototype.update=function(a,b){var c,d,e=this.fullWidth,f=this.fullHeight,g=this.pxRatio,h=this.drawOffset,i=this.buffer,j=this.canvas,k=this.btx,l=this.ctx;null==a?(a=this._endTime-this._startTime,c=this.current+=(a-this.current)*this.updateFactor,d=this.max*=.99):c=d=a,c>d&&(d=this.max=c),k.clearRect(0,0,e,f),k.drawImage(j,-h*g,0,e,f),l.clearRect(0,0,e,f),l.drawImage(i,0,0,e,f),l.drawImage(this.line,0,c*f/(d||1),g,f,e-g,0,g,f),!b&&++this._textTick>6&&(this._textTick=0,this._valueEl.textContent=c.toFixed(3)),this._startTime=this._endTime=0}}(),function(){function a(a){var b=a.name,c=document.getElementById("cover-"+b),d=this.toggle=document.getElementById("toggle-"+b),e=this.modal=document.getElementById(b);this.isActive=!1,this._toggleClassName=d.className,this._modalClassName=e.className,d.addEventListener("click",this.toggleState.bind(this),!1),c.addEventListener("click",this.toggleState.bind(this),!1)}App.ModalComponent=a,a.create=App.ctor(a),a.prototype.toggleState=function(a){this.isActive?(this.modal.className=this._modalClassName,this.toggle.className=this._toggleClassName,this.isActive=!1):(this.modal.className+=" active",this.toggle.className+=" active",this.isActive=!0)}}(),function(){function a(a){var b=a.name,c=this.toggle=document.getElementById("toggle-"+b);this.setupKey(a.key),this.setupMenu(a.menu),this.isActive=null!=a.isActive?a.isActive:!1,this._toggleClassName=c.className,this.syncState(),c.addEventListener("click",this.toggleState.bind(this),!1)}App.ToggleComponent=a,a.create=App.ctor(a),App.Dispatcher.extend(a.prototype),a.prototype.setupKey=function(a){a&&this.keyDelegator.addBinding(a,this,"toggleState")},a.prototype.setupMenu=function(a){if(a){var b=this.menu=document.getElementById("menu-"+a),c=this.menuInner=document.createElement("div");c.className="inner",b.appendChild(c),this._menuClassName=b.className,this.toggle.className+=" has-menu"}},a.prototype.toggleState=function(a){this.isActive=!this.isActive,this.syncState(),this.triggerListeners("toggle",this.isActive)},a.prototype.syncState=function(){this.updateElClass(this.toggle,this._toggleClassName),this.updateElClass(this.menu,this._menuClassName),this.updateElHeight(this.menu,this.menuInner)},a.prototype.updateElClass=function(a,b){a&&(this.isActive?a.className+=" active":a.className=b)},a.prototype.updateElHeight=function(a,b){a&&(this.isActive?(a.style.height=b.offsetHeight+"px",this._willBecomeVisible=setTimeout(this.becomeVisible.bind(null,a),200)):a.style.height="")},a.prototype.becomeVisible=function(a){a.className+=" visible"},a.prototype.hide=function(){this.toggle.className+=" hidden",this.menu.className+=" hidden"},a.prototype.keyDelegator=App.KeyDelegator.create()}(),function(){function a(a,b,c,d){Particulate.PlaneConstraint.apply(this,arguments),this.distance=0}App.LocalPlaneConstraint=a,a.create=Particulate.ctor(a),a.prototype=Object.create(Particulate.PlaneConstraint.prototype),a.prototype.constructor=a,a.prototype.applyConstraint=function(a,b,c){var d=this.bufferVec3,e=this.indices,f=e[1],g=e[a+3],h=3*f,i=h+1,j=h+2,k=3*g,l=k+1,m=k+2;if(0===a&&this._calculateNormal(a,b),this._hasNormal){var n=d[0],o=d[1],p=d[2],q=b[k]-b[h],r=b[l]-b[i],s=b[m]-b[j],t=q*n+r*o+s*p;t>this.distance||(b[k]-=n*t,b[l]-=o*t,b[m]-=p*t)}}}(),function(){function a(a,b){b=b||{},Particulate.Force.apply(this,arguments),this.position=this.vector,this.intensity=null!=b.intensity?b.intensity:.05,this.setRadius(b.radius||0)}var b=Particulate.Math;App.PointRepulsorForce=a,a.create=Particulate.ctor(a),a.prototype=Object.create(Particulate.Force.prototype),a.prototype.constructor=a,a.prototype.setRadius=function(a){this._radius2=a*a},a.prototype.applyForce=function(a,c,d,e){var f=this.vector,g=a+1,h=a+2,i=d[a]-f[0],j=d[g]-f[1],k=d[h]-f[2],l=i*i+j*j+k*k,m=b.clamp(.001,100,l-this._radius2*this.intensity),n=1/m,o=b.clamp(0,10,n*n*n);c[a]+=i*o,c[g]+=j*o,c[h]+=k*o}}(),function(){function a(a){var b=App.shaders[a];return b({chunks:THREE.ShaderChunk})}function b(b){this.shader&&(this.uniforms=THREE.UniformsUtils.clone(this.shader.uniforms),this.setUniformParameters(b),THREE.ShaderMaterial.call(this,{uniforms:this.uniforms,fragmentShader:a(this.shader.fragmentShader),vertexShader:a(this.shader.vertexShader)}),this.transparent=b.transparent||!1,this.blending=b.blending||THREE.NormalBlending,this.side=b.side||THREE.FrontSide,this.linewidth=b.linewidth||1,this.depthTest=null!=b.depthTest?b.depthTest:!0,this.depthWrite=null!=b.depthWrite?b.depthWrite:!0,this.size=b.size||1,this.sizeAttenuation=b.sizeAttenuation,this.fog=!!b.fog,this.map=!!b.map,this.bumpMap=!!b.bumpMap,this.normalMap=!!b.normalMap,this.specularMap=!!b.specularMap)}App.ShaderMaterial=b,b.prototype=Object.create(THREE.ShaderMaterial.prototype),b.prototype.setUniformParameters=function(a){var b=this.uniforms;Object.keys(a).forEach(function(c){var d=b[c];if(d)switch(d.type){case"c":this[c]=b[c].value=new THREE.Color(a[c]);break;default:this[c]=b[c].value=a[c]}}.bind(this))}}(),function(){function a(a){a=a||{},b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.AlphaMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"alpha-vert",fragmentShader:"alpha-frag",uniforms:THREE.UniformsUtils.merge([c.common])}}(),function(){function a(a){a=a||{},a.map=!0,b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.BulbMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"normal-vert",fragmentShader:"bulb-frag",uniforms:THREE.UniformsUtils.merge([c.common,{diffuseB:{type:"c",value:null},stepProgress:{type:"f",value:0},time:{type:"f",value:0}}])}}(),function(){function a(a){a=a||{},b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.DustMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"dust-vert",fragmentShader:"dust-frag",uniforms:THREE.UniformsUtils.merge([c.common,c.points,{time:{type:"f",value:0},area:{type:"f",value:1}}])}}(),function(){function a(a){a=a||{},b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.GelMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"gel-vert",fragmentShader:"gel-frag",uniforms:THREE.UniformsUtils.merge([c.common,{stepProgress:{type:"f",value:0}}])}}(),function(){function a(a){a=a||{},b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.LerpMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"lerp-vert",fragmentShader:"basic-frag",uniforms:THREE.UniformsUtils.merge([c.common,{stepProgress:{type:"f",value:0}}])}}(),function(){function a(a){a=a||{},a.sizeAttenuation=!0,b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.LerpPointMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"lerp-point-vert",fragmentShader:"basic-point-frag",uniforms:THREE.UniformsUtils.merge([c.points,{stepProgress:{type:"f",value:0}}])}}(),function(){function a(a){a=a||{},a.map=!0,b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.TailMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"normal-vert",fragmentShader:"tail-frag",uniforms:THREE.UniformsUtils.merge([c.common,{diffuseB:{type:"c",value:null},scale:{type:"f",value:1},stepProgress:{type:"f",value:0}}])}}(),function(){function a(a){a=a||{},b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.TentacleMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"tentacle-vert",fragmentShader:"tentacle-frag",uniforms:THREE.UniformsUtils.merge([c.common,{stepProgress:{type:"f",value:0},area:{type:"f",value:1}}])}}(),function(){function a(a){a=a||{},a.map=!0,b.call(this,a)}var b=App.ShaderMaterial,c=THREE.UniformsLib;App.UVMaterial=a,a.prototype=Object.create(b.prototype),a.prototype.shader={vertexShader:"basic-vert",fragmentShader:"uvs-frag",uniforms:THREE.UniformsUtils.merge([c.common])}}(),function(){function a(a,b,c){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.texture=new THREE.Texture(this.canvas),this.drawTexture(a,b,c)}App.LensDirtTexture=a,a.prototype.grayscaleColor=function(a,b,c){var d=Math.floor(Math.random()*b)+a;return"rgba("+[d,d,d,c].join(",")+")"},a.prototype.createGradients=function(a,b,c){for(var d,e,f,g,h,i,j,k,l,m=2*Math.PI/(b+1),n=0,o=[],p=0;b>p;p++)i=Math.cos(n)*c,j=Math.sin(n)*c,k=Math.cos(n+Math.PI)*c,l=Math.sin(n+Math.PI)*c,f=.1*Math.random(),g=.5*Math.random(),d=this.grayscaleColor(100,100,f),e=this.grayscaleColor(100,100,g),h=a.createLinearGradient(i,j,k,l),h.addColorStop(.2,d),h.addColorStop(.8,e),o.push(h),h._alpha=g,n+=m;return o},a.prototype.drawBlob=function(a,b,c,d){var e,f,g,h,i=2*Math.PI/d,j=0,k=100*Math.random(),l=100*Math.random();a.beginPath();for(var m=0,n=d-1;n>m;m++)e=Math.cos(j)*b,f=Math.sin(j)*c,g=.01*(k+e),h=.01*(l+f),e+=5*noise.simplex2(g,h),f+=5*noise.simplex2(g,h),j+=i,0===m?a.moveTo(e,f):a.lineTo(e,f);a.closePath(),a.fill()},a.prototype.drawShadow=function(a,b){a.save(),a.shadowBlur=10,a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowColor=this.grayscaleColor(200,10,1);for(var c=0;b>c;c++)a.stroke();a.restore()},a.prototype.drawTexture=function(a,b,c){c=c||{};var d,e,f,g,h=this.canvas,i=this.ctx,j=c.detail||10,k=c.cellPad||10,l=a/b,m=.5*l,n=.5*(l-k),o=.5*n,p=this.createGradients(i,b,l);h.width=h.height=a,i.lineWidth=1;for(var q=0;b>q;q++){i.setTransform(1,0,0,1,0,0),i.translate(0,l*q+m);for(var r=0;b>r;r++)i.translate(0===r?m:l,0),f=Math.random()*o+o,g=Math.random()*o+o,e=Math.floor(Math.random()*p.length),d=p[e],i.fillStyle=d,i.strokeStyle=this.grayscaleColor(60,30,.5*d._alpha),this.drawBlob(i,f,g,j),this.drawShadow(i,2)}this.texture.needsUpdate=!0}}(),function(){function a(a){a=a||{};var b=a.quads||100,c=a.textureSize||1024,d=a.textureCells||10,e=a.textureCellPad||20,f=a.textureDetail||50;this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!1,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.scale=1,this.textureMap=new App.LensDirtTexture(c,d,{detail:f,cellPad:e}),this.geom=this.createQuadGeom(b,d),this.mesh=new THREE.Mesh(this.geom,new App.AlphaMaterial({color:16777215,opacity:.5,map:this.textureMap.texture,blending:THREE.AdditiveBlending,transparent:!0})),this.scene.add(this.mesh),this._quadIndex=0,this._quadCount=b}App.LensDirtPass=a,a.prototype.setSize=function(a,b){var c,d,e,f=this.camera;a>b?(c=1,d=e=b/a):(c=e=a/b,d=1),f.left=-c,f.right=c,f.top=d,f.bottom=-d,this.scale=e,f.updateProjectionMatrix()},a.prototype._quadGeomPosition=function(a){var b=new Float32Array(4*a*3),c=new THREE.BufferAttribute(b,3);return c},a.prototype._quadGeomIndex=function(a){for(var b,c,d,e,f=new Uint16Array(6*a),g=new THREE.BufferAttribute(f,1),h=0,i=0,j=0;a>j;j++)b=h,c=h+1,d=h+2,e=h+3,f[i]=b,f[i+1]=c,f[i+2]=d,f[i+3]=d,f[i+4]=e,f[i+5]=b,h+=4,i+=6;return g},a.prototype._quadGeomUv=function(a,b){for(var c=new Float32Array(4*a*2),d=new THREE.BufferAttribute(c,2),e=1/b,f=0,g=0,h=0,i=0;a>i;i++)c[f]=c[f+6]=e*h,c[f+1]=c[f+3]=e*g,c[f+2]=c[f+4]=e*(h+1),c[f+5]=c[f+7]=e*(g+1),f+=8,++h===b&&(h=0,++g===b&&(g=0));return d},a.prototype._quadGeomAlpha=function(a){var b=new Float32Array(4*a),c=new THREE.BufferAttribute(b,1);return c},a.prototype.createQuadGeom=function(a,b){var c=new THREE.BufferGeometry;return c.addAttribute("position",this._quadGeomPosition(a)),c.addAttribute("uv",this._quadGeomUv(a,b)),c.addAttribute("alpha",this._quadGeomAlpha(a)),c.setIndex(this._quadGeomIndex(a)),c},a.prototype._quadIndex=0,a.prototype.setQuadPosition=function(){var a=new THREE.Matrix4,b=new THREE.Matrix4,c=new THREE.Matrix4,d=new THREE.Matrix4,e=new THREE.Vector3,f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Vector3;return function(i,j,k,l,m){var n=this.geom.attributes.position,o=4*i,p=o+1,q=o+2,r=o+3;c.makeScale(m*this.scale,m*this.scale,1),b.makeRotationZ(l),a.makeTranslation(j,k,0),d.identity(),d.multiply(a),d.multiply(b),d.multiply(c),e.set(-1,-1,0),f.set(1,-1,0),g.set(1,1,0),h.set(-1,1,0),e.applyMatrix4(d),f.applyMatrix4(d),g.applyMatrix4(d),h.applyMatrix4(d),n.setXY(o,e.x,e.y),n.setXY(p,f.x,f.y),n.setXY(q,g.x,g.y),n.setXY(r,h.x,h.y),n.needsUpdate=!0}}(),a.prototype.setQuadAlpha=function(a,b){var c=this.geom.attributes.alpha,d=c.array,e=4*a;d[e]=b,d[e+1]=b,d[e+2]=b,d[e+3]=b,c.needsUpdate=!0},a.prototype.setGroup=function(a,b,c,d){for(var e,f,g,h,i=this._quadCount,j=this._quadIndex,k=j,l=0;a>l;l++)e=b+(Math.random()-.5)*d,f=c+(Math.random()-.5)*d,g=Math.random()*Math.PI*2,h=.15*Math.random(),this.setQuadPosition(k,e,f,g,h),this.setQuadAlpha(k,1),k=j+l,k>=i&&(j=this._quadIndex=0);this._quadIndex=k},a.prototype.update=function(a){for(var b=this.geom.attributes.alpha,c=b.array,d=0,e=c.length;e>d;d++)c[d]*=.995;b.needsUpdate=!0},a.prototype.render=function(a,b,c,d){this.renderToScreen?a.render(this.scene,this.camera):a.render(this.scene,this.camera,c,this.clear)}}(),function(){function a(a){this.pxRatio=a.pxRatio||1,this.particleSize=32*this.pxRatio,this.particleCount=8e3,this.area=300,this.createParticles(),this.createMaterials(),this.createItem()}var b=!1,c=THREE.Math.mapLinear;App.Dust=a,a.create=App.ctor(a),a.prototype.createParticles=function(){for(var a,b=this.particleCount,c=this.geometry=new THREE.BufferGeometry,d=new Float32Array(3*b),e=this.area,f=.5*e,g=0,h=d.length/3;h>g;g++)a=3*g,d[a]=Math.random()*e-f,d[a+1]=Math.random()*e-f,d[a+2]=Math.random()*e-f;c.addAttribute("position",new THREE.BufferAttribute(d,3))},a.prototype.createTexture=function(){var a,d,e,f=document.createElement("canvas"),g=new THREE.Texture(f),h=f.getContext("2d"),i=Math.pow(2,6),j=.5*i,k=2;f.width=f.height=i,h.fillStyle="#fff";for(var l=0;k>l;l++)a=l/(k-1),d=c(a*a,0,1,4,j),e=c(a,0,1,1,.05),h.beginPath(),h.arc(j,j,d,0,2*Math.PI),h.globalAlpha=e,h.fill();return g.needsUpdate=!0,b&&(document.body.appendChild(f),f.style.position="absolute"),g},a.prototype.createMaterials=function(){var a={psColor:16777215,opacity:.95,size:this.particleSize,map:this.createTexture(),
scale:150,area:this.area,blending:THREE.AdditiveBlending,transparent:!0,depthTest:!1,depthWrite:!1};this.materialFore=new App.DustMaterial(a),this.timeAttrFore=this.materialFore.uniforms.time},a.prototype.createItem=function(){this.itemFore=new THREE.Points(this.geometry,this.materialFore)},a.prototype.addTo=function(a){a.add(this.itemFore)},a.prototype.updateGraphics=function(a){this.timeAttrFore.value+=.005*a}}(),function(){function a(a){this.pxRatio=a.pxRatio||1,this.animTime=0,this.size=40,this.yOffset=20,this.segmentsCount=4,this.totalSegments=3*this.segmentsCount*3,this.ribsCount=20,this.ribRadius=15,this.tentacleGroupStart=6,this.tentacleGroupOffset=4,this.tentacleGroupCount=3,this.tentacleSegments=120,this.tentacleSegmentLength=1.5,this.tentacleWeightFactor=1.25,this.tailRibsCount=15,this.tailRibRadiusFactor=20,this.tailLinkOffset=2,this.tailArmSegments=100,this.tailArmSegmentLength=1,this.tailArmWeight=.5,this.createTempBuffers(),this.createGeometry(),this.createSystem(),this.createSceneItem(),this.removeTempBuffers(),this.initTweens()}function b(a){return r(w-.55*w*a*1.8)+u(100*a+2)/3}function c(a,b,c,d){for(var e,f,g=v(c/3),h=0;3>h;h++)e=a+g*h,f=a+g*(h+1),d.push(b+e%c,b+f%c);return d}function d(a,b,c){for(var d,e,f=1,g=b;g>f;f++)d=f/b,e=2*(.5>=d?d:1-d),c.push(e,a);return c.push(0,a),c}function e(a,b){for(var c=0,d=a;d>c;c++)b.push(0,0);return b}function f(a){return a*a*a}function g(a){return r(.25*a*w+.5*w)*(1-.9*a)}function h(a){return function(b,c){c=c||this[a],y.apply(c,b)}}var i=Particulate,j=App.Geometry,k=App.Links,l=App.Faces,m=App.Tweens,n=i.Vec3,o=i.PointConstraint,p=i.DistanceConstraint,q=i.AxisConstraint,r=Math.sin,s=Math.cos,t=Math.round,u=Math.log,v=Math.floor,w=Math.PI,x=.5*w,y=Array.prototype.push;App.Medusae=a,a.create=App.ctor(a),App.Dispatcher.extend(a.prototype),a.tempBuffers=["queuedConstraints","verts","links","weights","bulbFaces","tailFaces","mouthFaces","uvs","tentacles","tentLinks","innerLinks","skins"],a.prototype.createTempBuffers=function(){for(var b,c=a.tempBuffers,d=c.length-1;d>=0;d--)b=c[d],this[b]=[]},a.prototype.removeTempBuffers=function(){for(var b,c=a.tempBuffers,d=c.length-1;d>=0;d--)b=c[d],delete this[b]},a.prototype.createGeometry=function(){this.createCore(),this.createBulb(),this.createTail(),this.createMouth(),this.createTentacles()},a.prototype.createCore=function(){var a=this.verts,b=this.uvs,c=this.totalSegments,d=this.size,e=this.pinTop=0,f=this.pinMid=1,g=this.pinBottom=2;this.pinTail=3,this.pinTentacle=4;for(var h=this.indexTop=5,i=this.indexMid=6,k=this.indexBottom=7,m=this.topStart=8,n=[0,.5*d],o=[.5*d,.7*d],r=[d,2*d],s=[0,.5*d],t=p.create(n,[e,h]),u=p.create(o,[h,i]),v=p.create(s,[g,k]),w=p.create(r,[h,k]),x=q.create(e,f,[h,i,k]),y=this.yOffset,z=this.posTop=y+d,A=this.posMid=y,B=this.posBottom=y-d,C=this.posTail=y-this.tailArmSegments*this.tailArmSegmentLength,D=this.posTentacle=y-this.tentacleSegments*this.tentacleSegmentLength*1.5,E=[z,A,B,C,D,1.5*d,.5*-d,-d],F=0,G=E.length;G>F;F++)j.point(0,E[F],0,a),b.push(0,0);this.queueConstraints(t,u,v,w,x),l.radial(h,m,c,this.bulbFaces)},a.prototype.createBulb=function(){var a=this.ribsCount;this.ribs=[];for(var b=0,c=a;c>b;b++)this.createRib(b,a),b>0&&this.createSkin(b-1,b)},a.prototype.createInnerRib=function(a,b){for(var d=this.segmentsCount,e=this.totalSegments,f=[],g=0,h=d;h>g;g++)c(3*g,a,e,f);return p.create([.8*b,b],f)},a.prototype.createRib=function(a,c){var e=this.totalSegments,f=this.verts,g=this.uvs,h=this.size,i=a/c,l=h+this.yOffset-i*h,m=a*e+this.topStart,n=b(i),o=n*this.ribRadius;j.circle(e,o,l,f),d(i,e,g);var q,r,s,t=k.loop(m,e,[]),u=2*w*o/e,v=p.create([.9*u,u],t),x=2*w*o/3,y=this.createInnerRib(m,x),z=0===a,A=a===c-1;(z||A)&&(r=0===a?this.indexTop:this.indexBottom,s=0===a?1.25*o:o,q=p.create([.5*o,s],k.radial(r,m,e,[])),this.queueConstraints(q),z?this.addLinks(q.indices):this.addLinks(q.indices,this.innerLinks)),this.addLinks(v.indices,this.innerLinks),this.addLinks(y.indices,this.innerLinks),this.queueConstraints(v,y),this.ribs.push({start:m,radius:o,radiusSpine:s,yParam:i,yPos:l,outer:v,inner:y,spine:q})},a.prototype.createSkin=function(a,b){var c=this.totalSegments,d=this.ribs[a],e=this.ribs[b],f=n.distance(this.verts,d.start,e.start),g=p.create([.5*f,f],k.rings(d.start,e.start,c,[]));this.queueConstraints(g),this.addLinks(g.indices),l.rings(d.start,e.start,c,this.bulbFaces),this.skins.push({a:a,b:b})},a.prototype.updateRibs=function(a,b){for(var c,d,e,f,g,h,i=15,j=this.totalSegments,k=0,l=a.length;l>k;k++)c=a[k],d=c.radius+c.yParam*b*i,e=(c.radiusOuter||c.radius)+c.yParam*b*i,f=(c.radiusSpine||c.radius)+c.yParam*b*i,c.outer&&(g=2*w*e/j,c.outer.setDistance(.9*g,g)),c.inner&&(h=2*w*d/3,c.inner.setDistance(.8*h,h)),c.spine&&c.spine.setDistance(.8*d,f)},a.prototype.ribAt=function(a){var b=this.ribs,c=this.tailRibs;return c[c.length-a-1]||b[b.length-a+c.length-1]},a.prototype.createTentacles=function(){for(var a=this.tentacleGroupCount,b=0,c=a;c>b;b++)this.createTentacleGroup(b,a)},a.prototype.createTentacleGroup=function(a,b){for(var c=this.tentacleGroupStart+this.tentacleGroupOffset*a,d=this.ribAt(c),e=1-a/b,f=this.tentacleSegments,g=f*e*.25+.75*f,h=0,i=g;i>h;h++)this.createTentacleSegment(a,h,g,d),h>0?this.linkTentacle(a,h-1,h):this.attachTentacles(a,d);this.attachTentaclesSpine(a)},a.prototype.createTentacleSegment=function(a,b,c,d){var g=this.totalSegments,h=this.verts,i=this.uvs,k=d.radius*(.25*r(.25*b)+.5),l=-b*this.tentacleSegmentLength+this.yOffset,m=h.length/3,n=f(b/c)*this.tentacleWeightFactor;j.circle(g,k,l,h),e(g,i),this.queueWeights(m,g,n),0===b&&this.tentacles.push([]),this.tentacles[a].push({start:m})},a.prototype.attachTentacles=function(a,b){var c=this.tentacles[a][0],d=this.totalSegments,e=this.tentacleSegmentLength,f=p.create([.5*e,e],k.rings(b.start,c.start,d,[]));this.queueConstraints(f),this.addLinks(f.indices,this.tentLinks)},a.prototype.attachTentaclesSpine=function(a){var b=this.tentacles[a],c=b[b.length-1],d=c.start,e=this.pinTentacle,f=this.totalSegments,g=this.tentacleSegments*this.tentacleSegmentLength,h=p.create([.5*g,g],k.radial(e,d,f,[]));this.queueConstraints(h)},a.prototype.linkTentacle=function(a,b,c){var d=this.totalSegments,e=this.tentacles[a],f=e[b],g=e[c],h=this.tentacleSegmentLength,i=p.create([.5*h,h],k.rings(f.start,g.start,d,[]));this.queueConstraints(i),this.addLinks(i.indices,this.tentLinks),this.addLinks(i.indices,this.innerLinks)},a.prototype.createTail=function(){var a=this.tailRibsCount;this.tailRibs=[];for(var b=0,c=a;c>b;b++)this.createTailRib(b,a),this.createTailSkin(b-1,b)},a.prototype.createTailRib=function(a,b){var c=this.ribs[this.ribs.length-1],e=this.totalSegments,f=this.verts,h=this.uvs,i=this.size,l=a/b,m=c.yPos-l*i*.8,n=this.verts.length/3,o=g(l),q=o*c.radius,r=q+l*this.tailRibRadiusFactor;j.circle(e,q,m,f),d(l,e,h);var s,t,u=k.loop(n,e,[]),v=2*w*r/e,x=p.create([.9*v,1.5*v],u),y=2*w*q/3,z=this.createInnerRib(n,y);a===b-1&&(t=this.indexMid,s=p.create([.8*q,q],k.radial(t,n,e,[])),this.queueConstraints(s),this.addLinks(s.indices,this.innerLinks)),this.queueConstraints(x,z),a>this.tailLinkOffset&&this.addLinks(x.indices),this.tailRibs.push({start:n,yParam:1-l,radius:q,radiusOuter:r,inner:z,outer:x,spine:s})},a.prototype.createTailSkin=function(a,b){var c=this.totalSegments,d=0>a?this.ribs[this.ribs.length-1]:this.tailRibs[a],e=this.tailRibs[b],f=n.distance(this.verts,d.start,e.start),g=p.create([.5*f,f],k.rings(d.start,e.start,c,[]));this.queueConstraints(g),this.addLinks(g.indices,this.innerLinks),l.rings(d.start,e.start,c,this.tailFaces)},a.prototype.createMouth=function(){this.createMouthArmGroup(1,0,4,3),this.createMouthArmGroup(.8,1,8,3,3),this.createMouthArmGroup(.5,7,9,6)},a.prototype.createMouthArmGroup=function(a,b,c,d,e){for(var f=0,g=d;g>f;f++)this.createMouthArm(a,b,c,f,d,e)},a.prototype.createMouthArm=function(a,b,c,d,e,f){for(var g,h,i,m,o,q,u,v=d/e,y=this.verts,z=this.uvs,A=this.posMid,B=this.ribAt(b),C=this.ribAt(c),D=this.totalSegments,E=(t(D*v)+(f||0))%D,F=B.start+E,G=C.start+E,H=n.distance(y,F,G),I=this.tailArmSegments,J=t(a*I),K=this.tailArmSegmentLength,L=2.4*K,M=20+(I-J)*this.tailArmSegmentLength,N=y.length/3,O=N+J-1,P=N+J,Q=k.line(N,J,[F,N]),R=k.line(P,J,[G,P]),S=[],T=[],U=[],V=2*Math.PI*v,W=s(V),X=r(V),Y=0;J>Y;Y++)u=Y/(J-1),j.point(0,A-Y*K,0,y),z.push(u,0);for(Y=0;J>Y;Y++)u=Y/(J-1),m=N+Y,o=P+Y,q=H*(.25*r(x+10*u)+.75)*(.25*r(x+20*u)+.75)*(.15*r(x+26*u)+.85)*r(x+.45*w*u),g=W*q,i=X*q,h=A-Y*K,j.point(g,h,i,y),z.push(u,1),S.push(p.create(q,m,o)),Y>10&&T.push(m-10,o),Y>1&&U.push(m-1,o),Y>1&&l.quadDoubleSide(m-1,o-1,o,m,this.mouthFaces);var Z=p.create([.25*K,K],Q),$=p.create([.25*L,L],R),_=p.create([.5*q,1/0],T),aa=p.create([0,M],O,this.pinTail);this.queueConstraints(Z,$,_,aa),this.queueConstraints(S),this.queueWeights(N,2*J,this.tailArmWeight),this.addLinks(Q),this.addLinks(R),this.addLinks(U,this.tentLinks),this.addLinks(T,this.tentLinks),this.addLinks(Q,this.innerLinks),this.addLinks(R,this.innerLinks),this.addLinks(U,this.innerLinks),this.addLinks(T,this.innerLinks),this.addLinks(aa.indices,this.innerLinks)},a.prototype.queueConstraints=function(a){y.apply(this.queuedConstraints,a.length?a:arguments)},a.prototype.queueWeights=function(a,b,c){var d,e,f=this.weights,g=a+b;if(f.length-1<g)for(d=0,e=g-f.length;e>d;d++)f.push(1);for(d=a,e=g;e>d;d++)f[d]=c},a.prototype.createSystem=function(){for(var a=this.queuedConstraints,b=this.weights,c=this.system=i.ParticleSystem.create(this.verts,2),d=0,e=a.length;e>d;d++)c.addConstraint(a[d]);for(d=0,e=b.length;e>d;d++)c.weights[d]=b[d];c.setWeight(this.pinTop,0),c.setWeight(this.pinMid,0),c.setWeight(this.pinBottom,0),c.setWeight(this.pinTail,0),c.addPinConstraint(o.create([0,this.posTop,0],this.pinTop)),c.addPinConstraint(o.create([0,this.posMid,0],this.pinMid)),c.addPinConstraint(o.create([0,this.posBottom,0],this.pinBottom)),c.addPinConstraint(o.create([0,this.posTail,0],this.pinTail)),c.addPinConstraint(o.create([0,this.posTentacle,0],this.pinTentacle))},a.prototype.relax=function(a){for(var b=this.system,c=0;a>c;c++)b.tick(1)},a.prototype.addLinks=h("links"),a.prototype.addFaces=h("bulbFaces"),a.prototype.addTimeAttr=function(a){this.timeAttrs||(this.timeAttrs=[]),this.timeAttrs.push(a.material.uniforms.time)},a.prototype.addStepAttr=function(a){this.stepAttrs||(this.stepAttrs=[]),this.stepAttrs.push(a.material.uniforms.stepProgress)},a.prototype.createSceneItem=function(){this.item=new THREE.Group,this.position=new THREE.BufferAttribute(this.system.positions,3),this.positionPrev=new THREE.BufferAttribute(this.system.positionsPrev,3),this.uvs=new THREE.BufferAttribute(new Float32Array(this.uvs),2),this.colors=[],this.stepAttrs=[],this.createMaterialsDots(),this.createMaterialsTentacles(),this.createMaterialsLines(),this.createMaterialsInnerLines(),this.createMaterialsTail(),this.createMaterialsMouth(),this.createMaterialsBulb(),this.item.position.setY(20)},a.prototype.addColor=function(a,b,c){c=c||"diffuse";var d=b.uniforms[c];this.colors.push({label:a,uniform:d})},a.prototype.createTextureDots=function(){var a=document.createElement("canvas"),b=new THREE.Texture(a),c=a.getContext("2d"),d=Math.pow(2,6),e=.5*d,f=0;return a.width=a.height=d,c.lineWidth=.25*d,c.strokeStyle="#fff",c.beginPath(),c.moveTo(e,f),c.lineTo(e,d-f),c.moveTo(f,e),c.lineTo(d-f,e),c.stroke(),b.needsUpdate=!0,b},a.prototype.createMaterialsDots=function(){var a=new THREE.BufferGeometry;a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev);var b=this.dots=new THREE.Points(a,new App.LerpPointMaterial({psColor:16777215,size:2e3*this.pxRatio,map:this.createTextureDots(),transparent:!0,depthTest:!1,depthWrite:!1}));this.dotsOpacity=b.material.uniforms.opacity,this.addStepAttr(b),this.item.add(b)},a.prototype.createMaterialsLines=function(){var a=new THREE.BufferGeometry,b=new THREE.BufferAttribute(new Uint16Array(this.links),1);a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev),a.setIndex(b);var c=this.linesFore=new THREE.LineSegments(a,new App.TentacleMaterial({diffuse:16768489,area:1200,transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1}));this.linesForeOpacity=c.material.uniforms.opacity,this.addStepAttr(c),this.addColor("Hood Contour",c.material),this.item.add(c)},a.prototype.createMaterialsInnerLines=function(){var a=new THREE.BufferGeometry,b=new THREE.BufferAttribute(new Uint16Array(this.innerLinks),1);a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev),a.setIndex(b);var c=this.linesInner=new THREE.LineSegments(a,new App.LerpMaterial({diffuse:16359101,transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1}));this.linesInnerOpacity=c.material.uniforms.opacity,this.addStepAttr(c),this.item.add(c)},a.prototype.createMaterialsTentacles=function(){var a=new THREE.BufferGeometry,b=new THREE.BufferAttribute(new Uint16Array(this.tentLinks),1);a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev),a.setIndex(b);var c=this.tentacleFore=new THREE.LineSegments(a,new App.TentacleMaterial({diffuse:10056345,area:2e3,transparent:!0,depthTest:!1,depthWrite:!1}));this.tentacleOpacity=c.material.uniforms.opacity,this.addStepAttr(c),this.addColor("Tentacles",c.material),this.item.add(c)},a.prototype.createMaterialsBulb=function(){var a=new THREE.BufferGeometry,b=new THREE.BufferAttribute(new Uint16Array(this.bulbFaces),1);a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev),a.addAttribute("uv",this.uvs),a.setIndex(b);var c=this.bulbMesh=new THREE.Mesh(a,new App.BulbMaterial({diffuse:16755154,diffuseB:7349612,transparent:!0})),d=new THREE.Mesh(a,new App.GelMaterial({diffuse:4283061,blending:THREE.AdditiveBlending,transparent:!0,depthTest:!1,depthWrite:!1}));c.scale.multiplyScalar(.95),d.scale.multiplyScalar(1.05),this.bulbFaintOpacity=d.material.uniforms.opacity,this.bulbOpacity=c.material.uniforms.opacity,this.addStepAttr(d),this.addStepAttr(c),this.addTimeAttr(c),this.addColor("Hood Primary",c.material),this.addColor("Hood Secondary",c.material,"diffuseB"),this.addColor("Hood Tertiary",d.material),this.item.add(d),this.item.add(c)},a.prototype.createMaterialsTail=function(){var a=new THREE.BufferGeometry,b=new THREE.BufferAttribute(new Uint16Array(this.tailFaces),1);a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev),a.addAttribute("uv",this.uvs),a.setIndex(b);var c=this.tailMesh=new THREE.Mesh(a,new App.TailMaterial({diffuse:14990318,diffuseB:2363704,scale:20,transparent:!0}));this.tailMesh.scale.multiplyScalar(.95),this.tailOpacity=c.material.uniforms.opacity,this.addStepAttr(c),this.addColor("Belly Primary",c.material),this.addColor("Belly Secondary",c.material,"diffuseB"),this.item.add(c)},a.prototype.createMaterialsMouth=function(){var a=new THREE.BufferGeometry,b=new THREE.BufferAttribute(new Uint16Array(this.mouthFaces),1);a.addAttribute("position",this.position),a.addAttribute("positionPrev",this.positionPrev),a.addAttribute("uv",this.uvs),a.setIndex(b);var c=this.mouthMesh=new THREE.Mesh(a,new App.TailMaterial({diffuse:15705840,diffuseB:4876238,scale:3,transparent:!0}));this.mouthOpacity=c.material.uniforms.opacity,this.addStepAttr(c),this.addColor("Mouth Primary",c.material),this.addColor("Mouth Secondary",c.material,"diffuseB"),this.item.add(c)},a.prototype.addTo=function(a){a.add(this.item)},a.prototype.toggleDots=function(){var a=this._dotsAreVisible=!this._dotsAreVisible;this._meshOpacity=a?.1:1,this._dotsOpacity=a?1:0},a.prototype.initTweens=function(){this._tweens={},this.tween=m.factorTween(this._tweens,.05)},a.prototype.updateTweens=function(a){var b=this.tween("mesh",this._meshOpacity||1),c=this.tween("dots",this._dotsOpacity||0),d=c>.001;this.bulbOpacity.value=.75*b,this.bulbFaintOpacity.value=.25*b,this.tentacleOpacity.value=.25*b,this.tailOpacity.value=.75*b,this.mouthOpacity.value=.65*b,this.linesForeOpacity.value=.35*b,this.linesInnerOpacity.value=.15*c,this.dotsOpacity.value=.25*c,this.linesInner.visible=d,this.dots.visible=d,this.needsRender=Math.abs(c-this._dotsOpacity)>.001},a.prototype.updateLineWidth=function(a){var b=t(a),c=t(2*a);this.linesFore.material.linewidth=b,this.linesInner.material.linewidth=b,this.tentacleFore.material.linewidth=c},a.prototype.PHASE_ZERO=.001,a.prototype.PHASE_OFFSET=.485,a.prototype.timePhase=function(a){return.5*(r(a*Math.PI-.5*Math.PI)+1)},a.prototype.update=function(a){var b=this.animTime+=.001*a,c=this.timePhase(b),d=this.timePhase(b-this.PHASE_OFFSET);!this._didPhaseTop&&1-d<this.PHASE_ZERO&&(this.triggerListeners("phase:top"),this._didPhaseTop=!0),d<this.PHASE_ZERO&&(this.triggerListeners("phase:bottom"),this._didPhaseTop=!1),this.updateRibs(this.ribs,c),this.updateRibs(this.tailRibs,c),this.system.tick(.001*a),this.position.needsUpdate=!0,this.positionPrev.needsUpdate=!0},a.prototype.updateGraphics=function(a,b){var c,d=this.timeAttrs,e=this.stepAttrs,f=this.animTime;for(c=0;c<d.length;c++)d[c].value=f;for(c=0;c<e.length;c++)e[c].value=b}}(),function(){function a(a){a=a||{},this.ctx=this.createAudioContext(),this.baseUrl=a.baseUrl,this.volume=0,this.distance=0,this.tween=b.factorTween({volume:0},.1),this._bufferCache={},this._activeRequests={},this._activeSounds=[]}var b=App.Tweens;App.AudioController=a,a.create=App.ctor(a),App.Dispatcher.extend(a.prototype),a.prototype.VOLUME_ZERO=.001,a.prototype.AUDIO_TYPES=[{ext:"ogg",type:"audio/ogg; codecs=vorbis"},{ext:"mp3",type:"audio/mpeg;"}],a.prototype.createAudioContext=function(){var a=window.AudioContext||window.webkitAudioContext;return new a},a.prototype.canCopyBuffers=window.AudioBuffer&&window.AudioBuffer.prototype.copyFromChannel,a.prototype.getAudioType=function(){if(this._audioType)return this._audioType;var a=new Audio,b=this.AUDIO_TYPES.find(function(b){return!!a.canPlayType(b.type).replace(/^no$/,"")});return this._audioType=b,b},a.prototype._findOrLoadBuffer=function(a){var b=this._bufferCache[a];return b?new Promise(function(a){a(b)}):this._loadBuffer(a)},a.prototype._loadBuffer=function(a){var b=this._activeRequests,c=b[a];if(c)return c;var d=this._bufferCache,e=this.ctx,f=this.getAudioType(),g=this.baseUrl+a+"."+f.ext,h=new XMLHttpRequest;return h.open("GET",g,!0),h.responseType="arraybuffer",c=b[a]=new Promise(function(a,b){h.addEventListener("load",function(){e.decodeAudioData(h.response,a)}),h.send()}).then(function(c){return d[a]=c,delete b[a],c})},a.prototype._addActiveSound=function(a,b){return b=b||this._activeSounds,a.sourceNode.onended=this._removeActiveSound.bind(this,a,b),b.push(a)},a.prototype._removeActiveSound=function(a,b){b=b||this._activeSounds;var c=b.indexOf(a);return-1!==c&&b.splice(c,1),b.length},a.prototype.loadBuffer=function(a){var b=a.path;return this._findOrLoadBuffer(b)},a.prototype.sliceBuffer=function(a,b,c){var d,e=this.ctx,f=a.numberOfChannels,g=a.sampleRate,h=g*b,i=g*c,j=i-h,k=e.createBuffer(f,2*j,g),l=new Float32Array(j);for(d=0;f>d;d++)a.copyFromChannel(l,d,h),k.copyToChannel(l,d,0),l.reverse(),k.copyToChannel(l,d,j);return k},a.prototype.createSound=function(a,b){var c=this.ctx,d=c.createBufferSource(),e=c.createGain(),f=c.createBiquadFilter(),g=this.volume,h=null!=b.volume?b.volume:1,i=b.offsetTime,j={volume:h,buffer:a,startTime:c.currentTime,offsetTime:i,sourceNode:d,gainNode:e,filterNode:f};return f.type="lowpass",f.frequency.value=320,d.buffer=a,d.loop=!!b.loop,e.gain.value=g*h,d.connect(e),e.connect(f),f.connect(c.destination),null!=i&&d.start(0,i),j},a.prototype.createSoundSlice=function(a,b){var c=this.ctx,d=b.buffer,e=b.startTime,f=b.offsetTime||0,g=(c.currentTime-e+f)%d.duration,h=this.sliceBuffer(d,g,g+a);return b.offsetTime=g,this.createSound(h,{volume:.8*b.volume,offsetTime:0,loop:!0})},a.prototype.playSound=function(a){var b=a.path;return this._findOrLoadBuffer(b).then(function(b){var c=this.createSound(b,{volume:a.volume,loop:a.loop,offsetTime:0});return this._addActiveSound(c),c}.bind(this))},a.prototype.updateVolume=function(a){this._activeSounds.forEach(function(b){b.gainNode.gain.value=a*b.volume})},a.prototype.pause=function(){if(this.canCopyBuffers){var a=this._activeSounds.slice(),b=a.map(this.createSoundSlice.bind(this,.5));a.forEach(function(a){a.sourceNode.stop()}),this._pausedSounds=a,this._activeSounds=b,this.updateVolume(this.volume)}},a.prototype.resume=function(){if(this.canCopyBuffers){var a=this._activeSounds,b=this._pausedSounds;if(b){var c=[];b.forEach(function(a){var b=this.createSound(a.buffer,{offsetTime:a.offsetTime,volume:a.volume,loop:a.sourceNode.loop});this._addActiveSound(b,c)}.bind(this)),a.forEach(function(a){a.sourceNode.stop()}),this._pausedSounds=null,this._activeSounds=c,this.updateVolume(this.volume)}}},a.prototype.update=function(){var a=this.tween("volume",this.volume)*(1-this.distance);a!==this.volume&&this.updateVolume(a),this.isMuted&&a>this.VOLUME_ZERO&&(this.triggerListeners("unmute"),this.isMuted=!1),!this.isMuted&&a<=this.VOLUME_ZERO&&(this.triggerListeners("mute"),this.isMuted=!0)}}(),function(){function a(a){var b=[g.detectWebAudio(),g.detectAudioCodecs(["audio/ogg; codecs=vorbis","audio/mpeg;"]),g.detectAudioAutoplay()],c=d.create({name:"audio",key:h[2]});Promise.all(b).then(function(){a.initAudio(),a.addListener("load:audio",function(){c.addListener("toggle",a,"toggleAudio"),c.toggleState()})},function(a){c.hide(),App.log("Audio features not supported")})}function b(a){var b=d.create({name:"colors",menu:"colors",key:h[1]});g.detectInputType("color").then(function(){a.medusae.colors.forEach(function(c){var d=f.create({label:c.label,color:c.uniform.value});d.addListener("change",a,"makeDirty"),b.menuInner.appendChild(d.element)})},function(a){b.hide(),App.log("Color input not supported")})}function c(a){var b=App.Format,c=a.medusae.system,d=document.getElementById("particle-count"),e=document.getElementById("constraint-count"),f=document.getElementById("force-count"),g=c._localConstraints.reduce(function(a,b){return a+b._count},0);d.textContent=b.number(c._count),e.textContent=b.number(g),f.textContent=b.number(c._forces.length)}var d=App.ToggleComponent,e=App.ModalComponent,f=App.ColorComponent,g=App.Features,h=[85,73,79,80];App.register("index",function(){var f=App.MainScene.create(),g=document.getElementById("container-controls"),i=d.create({name:"dots",key:h[0]}),j=d.create({name:"postfx",key:h[3],isActive:f.usePostFx}),k=d.create({name:"sim",key:32,isActive:f.shouldAnimate});e.create({name:"info"}),f.initItems(),f.initForces(),f.appendRenderer(),j.addListener("toggle",f,"togglePostFx"),i.addListener("toggle",f,"toggleDots"),i.addListener("toggle",f,"toggleStats"),k.addListener("toggle",f,"toggleAnimate"),a(f),b(f),c(f),setTimeout(function(){f.loop.start(),g.className="active"},0)})}(),function(){App.register("tests",function(){document.body.className="testing"})}(),function(){function a(){var a=this.scene=new THREE.Scene,c=this.camera=new THREE.PerspectiveCamera(30,1,5,3500),d=this.element=document.getElementById("container");this.statsElement=document.getElementById("container-graphs"),this.mouse=new THREE.Vector2,this.raycaster=new THREE.Raycaster,this.nudgeIndex=0,this.pxRatio=b.clamp(1.5,2,window.devicePixelRatio),this.gravity=-2,this.usePostFx=!0,this.shouldAnimate=!0,this.initRenderer(),this.initFxComposer(),this.addPostFx(),this.initControls(),this.initStats(),this.onWindowResize();var e=this.height/1e3;c.position.set(400*e,300*e,0),c.lookAt(a.position),this.loop=App.Looper.create(this,"update","preRender",1/30*1e3),d.addEventListener("mousedown",this.onMouseDown.bind(this),!1),d.addEventListener("mousemove",this.onMouseMove.bind(this),!1),d.addEventListener("mouseup",this.onMouseUp.bind(this),!1),window.addEventListener("resize",this.onWindowResize.bind(this),!1)}var b=Particulate.Math,c=App.Tweens,d=!0,e=!1,f=!1;App.MainScene=a,a.create=App.ctor(a),App.Dispatcher.extend(a.prototype),a.prototype.initRenderer=function(){var a=this.renderer=new THREE.WebGLRenderer({antialias:!1});this.updateClearColor(),a.setPixelRatio(this.pxRatio),a.autoClear=!1,a.sortObjects=!1},a.prototype.updateClearColor=function(){var a=this.usePostFx?656910:1051159;this.renderer.setClearColor(a,1)},a.prototype.appendRenderer=function(){var a=this.renderer.domElement;this.element.appendChild(a),setTimeout(function(){a.className="active"},0)},a.prototype.initFxComposer=function(){var a=new THREE.WebGLRenderTarget(this.width,this.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearMipMapLinearFilter,format:THREE.RGBAFormat});this.composer=new THREE.EffectComposer(this.renderer,a),this._passIndex={}},a.prototype.addPostFx=function(){var a=.8,b=25,c=8,d=512,e=new THREE.RenderPass(this.scene,this.camera),f=new THREE.BloomPass(a,b,c,d),g=new THREE.ShaderPass(THREE.VignetteShader),h=this.lensDirtPass=new App.LensDirtPass({quads:200,textureSize:2048});g.material.uniforms.darkness.value=.5,g.material.uniforms.offset.value=1.25,g.material.uniforms.color.value=new THREE.Color(460556),this.addPass(e),this.addPass(f),this.addPass(h),this.addPass(g,!0)},a.prototype.addPass=function(a,b,c){return"string"==typeof a?this._passIndex[a]=b:(c=b,b=a),b.renderToScreen=c||!1,this.composer.addPass(b),b},a.prototype.getPass=function(a){return this._passIndex[a]},a.prototype.enablePass=function(a){var b=this.getPass(a);b&&(b.enabled=!0)},a.prototype.disablePass=function(a){var b=this.getPass(a);b&&(b.enabled=!1)},a.prototype.initItems=function(){var a=this.medusae=App.Medusae.create({pxRatio:this.pxRatio}),b=this.dust=App.Dust.create({pxRatio:this.pxRatio});a.addTo(this.scene),b.addTo(this.scene)},a.prototype.makeDirty=function(){this.needsRender=!0},a.prototype.togglePostFx=function(a){this.usePostFx=a,this.updateClearColor(),this.needsRender=!0},a.prototype.onWindowResize=function(){var a=window.innerWidth,b=window.innerHeight,d=this.pxRatio,e=a*d,f=b*d,g=a/b,h=b/1e3,i=200*h,j=1200*h;this.width=a,this.height=b,this.camera.aspect=g,this.camera.updateProjectionMatrix(),this.controls.minDistance=i,this.controls.maxDistance=j,this.controls.handleResize(),this.mapDistance=c.mapRange(i,j,0,1),this.mapSoundDistance=c.mapRange(i,1.3*j,0,1),this.renderer.setSize(a,b),this.composer.setSize(e,f),this.lensDirtPass.setSize(e,f),this.needsRender=!0},a.prototype.initForces=function(){var a=this.medusae,b=Particulate.DirectionalForce.create([0,this.gravity,0]),c=50,d=App.PointRepulsorForce.create([20,5,0],{radius:c,intensity:0});a.system.addForce(b),a.system.addForce(d),this.gravityForce=b,this.nudgeForce=d,f&&this.initDebugNudge(c)},a.prototype.initDebugNudge=function(a){var b=this.debugNudge=new THREE.Mesh(new THREE.SphereBufferGeometry(a,8,6),new THREE.MeshBasicMaterial({color:16777215,opacity:.2,transparent:!0})),c=new THREE.WireframeHelper(b,16777215);this.scene.add(c),this.scene.add(b)},a.prototype.updateDebugNudge=function(){var a=this.nudgeForce,b=a.position,c=Math.max(a.intensity,1e-4),d=this.debugNudge;d.scale.set(c,c,c),d.position.set(b[0],b[1],b[2])},a.prototype.initControls=function(){var a=new THREE.TrackballControls(this.camera,this.element);a.rotateSpeed=.75,a.zoomSpeed=.75,a.panSpeed=.6,a.noZoom=!d,a.noPan=!e,a.staticMoving=!1,a.dynamicDampingFactor=.2,a.keys=[65,17,16],a.addEventListener("change",this.onControlsChange.bind(this)),this.controls=a},a.prototype.onControlsChange=function(){this.needsRender=!0},a.prototype.toggleAnimate=function(a){var b=this.audio,c=this.audioIsPlaying,d=!this.shouldAnimate;b&&(d?b.resume():b.pause(),c&&(b.volume=d?1:.7)),this.shouldAnimate=d},a.prototype.toggleStats=function(){document.body.classList.toggle("show-info")},a.prototype.onMouseDown=function(a){this.didDrag=!1},a.prototype.onMouseMove=function(a){this.didDrag=!0},a.prototype.onMouseUp=function(a){if(!this.didDrag&&this.shouldAnimate){var b=this.mouse;b.x=a.clientX/window.innerWidth*2-1,b.y=2*-(a.clientY/window.innerHeight)+1,this.nudgeMedusae(),a.preventDefault()}},a.prototype.nudgeMedusae=function(){var a=new THREE.Vector3;return function(){var b=this.lastNudge,c=Date.now()-b;if(!(250>c)){c>800&&(this.nudgeIndex=0);var d=this.bubbleSequence,e=this.nudgeIndex;if(!(e>d.length-1)){var f=this.raycaster,g=this.mouse,h=this.sounds[d[e]];f.setFromCamera(g,this.camera);var i=f.intersectObject(this.medusae.bulbMesh);if(i.length){var j=this.nudgeForce,k=i[0].point,l=5*e,m=(e+1)/d.length+.5;a.copy(k).normalize().multiplyScalar(15),k.add(a),j.intensity=m,j.set(k.x,k.y,k.z),this.playSound(h),this.lensDirtPass.setGroup(l,g.x,g.y,.8),this.lastNudge=Date.now(),this.nudgeIndex++}}}}}(),a.prototype.sounds={bg:{path:"bg-loop",volume:1,loop:!0},wave:{path:"buzz-wave-4",volume:.8},bubblesLow:{path:"bubbles-1",volume:.6},bubblesHigh:{path:"bubbles-2",volume:.6}},a.prototype.bubbleSequence=["bubblesLow","bubblesLow","bubblesHigh"],a.prototype.initAudio=function(){var a=this.sounds,b=this.audio=App.AudioController.create({baseUrl:App.STATIC_URL+"audio/"});b.loadBuffer(a.bg).then(function(){b.playSound(a.bg),b.addListener("mute",this,"muteSounds"),b.addListener("unmute",this,"unmuteSounds"),setTimeout(this.triggerListeners.bind(this,"load:audio"),0)}.bind(this)),b.loadBuffer(a.wave).then(function(){this.medusae.addListener("phase:top",this,"audioPhaseTop")}.bind(this)),b.loadBuffer(a.bubblesLow),b.loadBuffer(a.bubblesHigh)},a.prototype.playSound=function(a){this.audio&&this.audioIsPlaying&&this.audio.playSound(a)},a.prototype.muteSounds=function(){},a.prototype.unmuteSounds=function(){},a.prototype.startAudio=function(){this.audio.volume=1,this.audioIsPlaying=!0},a.prototype.stopAudio=function(){this.audio.volume=0,this.audioIsPlaying=!1},a.prototype.toggleAudio=function(){this.audioIsPlaying?this.stopAudio():this.startAudio()},a.prototype.audioPhaseTop=function(){this.playSound(this.sounds.wave)},a.prototype.toggleDots=function(){this.medusae&&(this._renderStats=!this._renderStats,this.medusae.toggleDots())},a.prototype.initStats=function(){var a=this.statsElement;this.statsPhysics=App.GraphComponent.create({label:"Physics (ms)"}),this.statsGraphics=App.GraphComponent.create({label:"Graphics (ms)",updateFactor:.025}),this.statsPhysics.appendTo(a),this.statsGraphics.appendTo(a)},a.prototype.update=function(a){var b=this.medusae,c=this.audio,d=this.nudgeForce,e=this.camera.position.length(),g=this.mapDistance(e),h=this.mapSoundDistance(e),i=Math.max(.5,Math.round(2*(1-g)*1.5)/2);b.updateLineWidth(i),d.intensity*=.8,this.shouldAnimate&&(this.statsPhysics.start(),b.update(a),this.statsPhysics.end(),this.lensDirtPass.update(a)),c&&(c.distance=h,c.update(a)),f&&this.updateDebugNudge(a)},a.prototype.preRender=function(a,b){this.controls.update(),this.medusae.updateTweens(a),this.shouldAnimate||this.needsRender||this.medusae.needsRender?(this.render(a,b),this.needsRender=!1):this.statsGraphics.reset(),this._renderStats&&(this.loop.didUpdate?this.statsPhysics.update():this.statsPhysics.update(0,!0),this.statsGraphics.update())},a.prototype.render=function(a,b){this.statsGraphics.start(),this.shouldAnimate&&(this.medusae.updateGraphics(a,b),this.dust.updateGraphics(a,b)),this.usePostFx?this.composer.render(.01):(this.renderer.clear(),this.renderer.render(this.scene,this.camera)),this.statsGraphics.end()}}(),function(){setTimeout(function(){var a=!1;a&&location.search.indexOf("test=true")>-1?App.run("tests"):(App.run("index"),App.log("Particulate.js "+Particulate.VERSION))},0)}();